<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ™ºæ•™SmartEdu - æ•™å¸ˆç«¯</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <!-- Marked.js - Markdownè§£æåº“ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/9.1.6/marked.min.js"></script>
    <!-- html2canvaså’ŒjsPDF - PDFç”Ÿæˆåº“ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        /* è‡ªå®šä¹‰checkboxæ ·å¼ */
        .checkbox-container {
            display: flex;
            align-items: center;
            position: relative;
            padding-left: 0;
            padding-top: 4px;
            margin-bottom: 16px;
            cursor: pointer;
            font-size: 14px;
            user-select: none;
            line-height: 1.5;
        }

        .checkbox-container input {
            position: absolute;
            opacity: 0;
            cursor: pointer;
            height: 0;
            width: 0;
        }

        .checkmark {
            position: relative;
            top: 0;
            left: 0;
            height: 20px;
            width: 20px;
            min-width: 20px;
            margin-right: 12px;
            background-color: #eee;
            border: 2px solid #ddd;
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        .checkbox-container:hover input ~ .checkmark {
            background-color: #ccc;
        }

        .checkbox-container input:checked ~ .checkmark {
            background-color: #e74c3c;
            border-color: #e74c3c;
        }

        .checkmark:after {
            content: "";
            position: absolute;
            display: none;
        }

        .checkbox-container input:checked ~ .checkmark:after {
            display: block;
        }

        .checkbox-container .checkmark:after {
            left: 5px;
            top: 1px;
            width: 6px;
            height: 10px;
            border: solid white;
            border-width: 0 3px 3px 0;
            transform: rotate(45deg);
        }
        
        /* é€šçŸ¥è¡¨æ ¼æ ·å¼ */
        .notice-title-only {
            font-weight: 500;
            color: #2c3e50;
            line-height: 1.4;
        }
        
        .course-info {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }
        
        .course-name {
            font-weight: 500;
            color: #2c3e50;
            font-size: 14px;
        }
        
        .course-code {
            font-size: 12px;
            color: #7f8c8d;
            background-color: #f8f9fa;
            padding: 2px 6px;
            border-radius: 4px;
            display: inline-block;
            width: fit-content;
        }
        
        .priority-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 500;
            text-transform: uppercase;
            white-space: nowrap;
            display: inline-block;
        }
        
        .priority-normal {
            background-color: #ecf0f1;
            color: #7f8c8d;
        }
        
        .priority-important {
            background-color: #fff3cd;
            color: #856404;
        }
        
        .priority-urgent {
            background-color: #f8d7da;
            color: #721c24;
        }
        
        .status-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 500;
        }
        
        .status-sent {
            background-color: #d4edda;
            color: #155724;
        }
        
        .status-pending {
            background-color: #d1ecf1;
            color: #0c5460;
        }
        
        .action-buttons {
            display: flex;
            gap: 4px;
        }
        
        .action-buttons .btn {
            padding: 4px 8px;
            min-width: auto;
        }
        
        /* é€šçŸ¥è¡¨æ ¼åˆ—å®½è°ƒæ•´ */
        #notices-table th:nth-child(1) { width: 30%; } /* æ ‡é¢˜ */
        #notices-table th:nth-child(2) { width: 20%; } /* å‘å¸ƒæ—¶é—´ */
        #notices-table th:nth-child(3) { width: 25%; } /* è¯¾ç¨‹ */
        #notices-table th:nth-child(4) { width: 10%; } /* çŠ¶æ€ */
        #notices-table th:nth-child(5) { width: 15%; } /* æ“ä½œ */
        
        /* é€šçŸ¥è¯¦æƒ…æ ·å¼ */
        .detail-row {
            display: flex;
            margin-bottom: 12px;
            align-items: flex-start;
        }
        
        .detail-row label {
            min-width: 80px;
            font-weight: 500;
            color: #2c3e50;
            margin-right: 12px;
        }
        
        .detail-row span {
            flex: 1;
            color: #34495e;
        }
        
        .notice-content {
            flex: 1;
            color: #34495e;
            line-height: 1.6;
            white-space: pre-wrap;
            background-color: #f8f9fa;
            padding: 12px;
            border-radius: 6px;
            border: 1px solid #e9ecef;
        }
        
        /* æœ€è¿‘ä¸Šä¼ æ–‡æ¡£è¡¨æ ¼æ ·å¼ - å›ºå®šè¡Œé«˜ */
        #recent-documents-table {
            table-layout: fixed;
            width: 100%;
        }
        
        #recent-documents-table tbody tr {
            height: 50px;
        }
        
        #recent-documents-table tbody td {
            height: 50px;
            vertical-align: middle;
            padding: 8px 12px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            text-align: center;
        }
        
        #recent-documents-table thead th {
            text-align: center;
        }
        
        #recent-documents-table tbody td:last-child {
            white-space: nowrap;
            text-align: center;
        }
        
        /* æ“ä½œæŒ‰é’®æ ·å¼ */
        #recent-documents-table .btn {
            min-width: 32px;
            padding: 6px 8px;
            margin: 0 2px;
        }
        
        /* çŠ¶æ€å¾½ç« æ ·å¼ */
        #recent-documents-table .badge {
            padding: 4px 8px;
            font-size: 12px;
            white-space: nowrap;
        }
        
        /* å…¨éƒ¨æ–‡æ¡£æ¨¡æ€æ¡†è¡¨æ ¼æ ·å¼ */
        .modal .table tbody tr {
            height: 50px;
        }
        
        .modal .table tbody td {
            height: 50px;
            vertical-align: middle;
            padding: 8px 12px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            text-align: center;
        }
        
        .modal .table thead th {
            text-align: center;
        }
        
        .modal .table tbody td:last-child {
            white-space: nowrap;
            text-align: center;
        }
        
        .modal .table .btn {
            min-width: 32px;
            padding: 6px 8px;
            margin: 0 2px;
        }
        
        /* çŸ¥è¯†ç‚¹æŒæ¡æƒ…å†µæ ·å¼ */
        .knowledge-mastery-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 10px;
            background: rgba(52, 152, 219, 0.1);
            border-radius: 6px;
        }
        
        .knowledge-mastery-refresh-time {
            font-size: 12px;
            color: #7f8c8d;
        }
        
        .bar-container {
            margin-bottom: 16px;
            opacity: 0;
            transform: translateY(20px);
        }
        
        .bar-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 4px;
            font-size: 14px;
            font-weight: 500;
            color: #2c3e50;
        }
        
        .mastery-trend {
            font-size: 12px;
            padding: 2px 6px;
            border-radius: 3px;
            background: #ecf0f1;
            color: #7f8c8d;
        }
        
        .bar {
            height: 24px;
            border-radius: 12px;
            position: relative;
            transition: width 0.5s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .bar.high {
            background: linear-gradient(135deg, #27ae60, #2ecc71);
        }
        
        .bar.medium {
            background: linear-gradient(135deg, #f39c12, #f1c40f);
        }
        
        .bar.low {
            background: linear-gradient(135deg, #e74c3c, #ec7063);
        }
        
        .bar-value {
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            color: white;
            font-size: 12px;
            font-weight: 600;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }
        
        /* çŸ¥è¯†ç‚¹æŒæ¡æƒ…å†µåŠ¨ç”» */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes slideInRight {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        @keyframes slideOutRight {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(100%);
                opacity: 0;
            }
        }
        
        /* çŸ¥è¯†ç‚¹æŒæ¡æƒ…å†µæ›´æ–°é€šçŸ¥æ ·å¼ */
        .knowledge-mastery-update-notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #27ae60;
            color: white;
            padding: 12px 20px;
            border-radius: 6px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            font-weight: 500;
        }
        
        /* åŸ¹å…»ç›®æ ‡ç›¸å…³æ ·å¼ */
        .training-objectives-container {
            border: 2px dashed #e1e8ed;
            border-radius: 8px;
            padding: 16px;
            background: #f8f9fa;
        }
        
        .objective-item {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
            padding: 12px;
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            transition: all 0.3s ease;
        }
        
        .objective-item:hover {
            border-color: #3498db;
            box-shadow: 0 2px 8px rgba(52, 152, 219, 0.1);
        }
        
        .objective-input {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }
        
        .objective-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }
        
        .remove-objective-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 6px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: background-color 0.3s ease;
        }
        
        .remove-objective-btn:hover {
            background: #c0392b;
        }
        
        .add-objective-btn {
            background: #3498db;
            color: white;
            border: 2px dashed #3498db;
            padding: 10px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            width: 100%;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .add-objective-btn:hover {
            background: #2980b9;
            border-color: #2980b9;
            transform: translateY(-1px);
        }
        
        .training-objectives-display {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            padding: 12px;
            margin-top: 8px;
        }
        
        .training-objectives-display .objective-display-item {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
            padding: 8px 12px;
            background: white;
            border-radius: 4px;
            border-left: 4px solid #3498db;
        }
        
        .training-objectives-display .objective-display-item:last-child {
            margin-bottom: 0;
        }
        
        .training-objectives-display .objective-text {
            flex: 1;
            font-size: 14px;
            color: #2c3e50;
        }
        
        .training-objectives-display .objective-number {
            background: #3498db;
            color: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 12px;
            font-weight: 600;
            min-width: 20px;
            text-align: center;
        }
    </style>
</head>
<body>
    <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
    <header class="header">
        <div class="logo">
            <i class="fas fa-graduation-cap"></i>
            <span>æ™ºæ•™ SmartEdu</span>
        </div>
        
        <div class="user-controls">
            <div class="user-avatar-container" id="user-avatar-container">
                <div class="user-avatar" id="user-avatar">
                    <i class="fas fa-chalkboard-teacher"></i>
                </div>
            </div>
            <div class="user-profile" id="user-profile">
                <span class="user-name" id="current-username">ç”¨æˆ·</span>
                <i class="fas fa-caret-down"></i>
                <div class="user-dropdown" id="user-dropdown">
                    <div class="dropdown-item" data-action="edit-profile">
                        <i class="fas fa-user-edit"></i>
                        <span>ç¼–è¾‘ä¸ªäººä¿¡æ¯</span>
                    </div>
                    <div class="dropdown-divider"></div>
                    <div class="dropdown-item" onclick="showDeleteAccountModal()" style="color: #e74c3c;">
                        <i class="fas fa-user-times"></i>
                        <span>æ³¨é”€è´¦æˆ·</span>
                    </div>
                    <div class="dropdown-divider"></div>
                    <div class="dropdown-item" onclick="handleLogout()">
                        <i class="fas fa-sign-out-alt"></i>
                        <span>é€€å‡ºç™»å½•</span>
                    </div>
                </div>
            </div>

        </div>
    </header>

    <!-- å·¦ä¾§èœå•æ  -->
    <nav class="sidebar" id="sidebar">
        <div class="menu-title">æ•™å¸ˆç«¯</div>
        
        <div class="menu-item active" data-section="dashboard">
            <i class="fas fa-gauge-high"></i>
            <span>æ•™å­¦æ§åˆ¶é¢æ¿</span>
        </div>
        
        <div class="menu-item">
            <i class="fas fa-lightbulb"></i>
            <span>å¤‡è¯¾ä¸è®¾è®¡</span>
            <i class="fas fa-chevron-down arrow"></i>
        </div>
        <div class="submenu">
            <div class="submenu-item" data-section="my-courses"><i class="fas fa-list"></i> æˆ‘çš„è¯¾ç¨‹</div>
            <div class="submenu-item" data-section="upload-material"><i class="fas fa-upload"></i> æ„å»ºè¯¾ç¨‹çŸ¥è¯†åº“</div>
            <div class="submenu-item active" data-section="outline"><i class="fas fa-sitemap"></i> ç”Ÿæˆæ•™å­¦å¤§çº²</div>
            <div class="submenu-item" data-section="publish-notice"><i class="fas fa-bullhorn"></i> å‘å¸ƒé€šçŸ¥</div>
        </div>
        
        <div class="menu-item">
            <i class="fas fa-file-signature"></i>
            <span>è€ƒæ ¸å†…å®¹ç”Ÿæˆ</span>
            <i class="fas fa-chevron-down arrow"></i>
        </div>
        <div class="submenu">
            <div class="submenu-item" data-section="gen-test"><i class="fas fa-pen-nib"></i> ç”Ÿæˆæµ‹è¯„</div>
            <div class="submenu-item" data-section="test-manage"><i class="fas fa-tasks"></i> æµ‹è¯„ç®¡ç†</div>
        </div>
        
        <div class="menu-item">
            <i class="fas fa-chart-pie"></i>
            <span>å­¦æƒ…æ•°æ®åˆ†æ</span>
            <i class="fas fa-chevron-down arrow"></i>
        </div>
        <div class="submenu">
            <div class="submenu-item" data-section="grade-mark"><i class="fas fa-marker"></i> æˆç»©æ‰¹æ”¹</div>
            <div class="submenu-item" data-section="grade-analysis"><i class="fas fa-chart-bar"></i> æˆç»©åˆ†æ</div>
            <div class="submenu-item" data-section="improve-suggest"><i class="fas fa-lightbulb"></i> æ•™å­¦æ”¹è¿›å»ºè®®</div>
        </div>
        

        
        <div class="menu-item">
            <i class="fas fa-comments"></i>
            <span>äº’åŠ¨äº¤æµ</span>
            <i class="fas fa-chevron-down arrow"></i>
        </div>
        <div class="submenu">
            <div class="submenu-item" data-section="message-conversations"><i class="fas fa-comment-dots"></i> å¯¹è¯åˆ—è¡¨</div>
            <div class="submenu-item" data-section="message-new-chat"><i class="fas fa-plus-circle"></i> æ–°å»ºå¯¹è¯</div>
        </div>
    </nav>

    <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
    <main class="content" id="main-content">
        <section id="dashboard" class="main-section">
            <div class="content-header">
                <h1 class="page-title">æ•™å­¦æ§åˆ¶é¢æ¿</h1>
                <div class="header-actions">
                    <button class="btn btn-primary" onclick="refreshDashboardData()">
                        <i class="fas fa-sync-alt"></i> åˆ·æ–°æ•°æ®
                    </button>
                    <button class="btn btn-accent" onclick="showCreateCourseModal()">
                        <i class="fas fa-plus"></i> æ–°å»ºè¯¾ç¨‹
                    </button>
                </div>
            </div>
            
            <div class="stats-container">
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-title">æ´»è·ƒå­¦ç”Ÿ</div>
                        <div class="stat-icon" style="background-color: rgba(52, 152, 219, 0.1);">
                            <i class="fas fa-users" style="color: var(--primary-color);"></i>
                        </div>
                    </div>
                    <div class="stat-value">0</div>
                    <div class="stat-change">
                        <!-- åŠ¨æ€æ•°æ®ï¼Œæ— å˜åŒ–è¶‹åŠ¿ -->
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-title">å¹³å‡åˆ†</div>
                        <div class="stat-icon" style="background-color: rgba(39, 174, 96, 0.1);">
                            <i class="fas fa-chart-line" style="color: var(--success-color);"></i>
                        </div>
                    </div>
                    <div class="stat-value">0.0%</div>
                    <div class="stat-change">
                        <!-- åŠ¨æ€æ•°æ®ï¼Œæ— å˜åŒ–è¶‹åŠ¿ -->
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-title">å¾…æ‰¹æ”¹è¯•å·</div>
                        <div class="stat-icon" style="background-color: rgba(231, 76, 60, 0.1);">
                            <i class="fas fa-file-alt" style="color: var(--danger-color);"></i>
                        </div>
                    </div>
                    <div class="stat-value">0</div>
                    <div class="stat-change down">
                        <!-- åŠ¨æ€æ•°æ®ï¼Œæ— å˜åŒ–è¶‹åŠ¿ -->
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-title">è¯¾ç¨‹æ•°</div>
                        <div class="stat-icon" style="background-color: rgba(26, 188, 156, 0.1);">
                            <i class="fas fa-layer-group" style="color: var(--accent-color);"></i>
                        </div>
                    </div>
                    <div class="stat-value">0</div>
                    <div class="stat-change">
                        <!-- åŠ¨æ€æ•°æ®ï¼Œæ— å˜åŒ–è¶‹åŠ¿ -->
                    </div>
                </div>
            </div>
            
            <!-- æœ€è¿‘è¯¾ç¨‹æ¨¡å—ç‹¬ç«‹æˆè¡Œ -->
            <div class="recent-courses-card">
                <div class="card-header">
                    <i class="fas fa-clock"></i> æœ€è¿‘è¯¾ç¨‹
                    <div class="card-actions">
                        <button class="btn btn-sm btn-accent" onclick="showSection('my-courses')">
                            <i class="fas fa-eye"></i> æŸ¥çœ‹å…¨éƒ¨
                        </button>
                    </div>
                </div>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>è¯¾ç¨‹åç§°</th>
                                <th>è¯¾ç¨‹å·</th>
                                <th>å­¦ç”Ÿæ•°é‡</th>
                                <th>æœ€åæ›´æ–°</th>
                                <th>å®Œæˆç‡</th>
                                <th>æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- åŠ¨æ€å†…å®¹ï¼Œç”±JavaScriptåŠ è½½ -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- çŸ¥è¯†ç‚¹æŒæ¡æƒ…å†µæ¨¡å—ç‹¬ç«‹æˆè¡Œ -->
            <div class="knowledge-mastery-card">
                <div class="card-header">
                    <i class="fas fa-chart-bar"></i> çŸ¥è¯†ç‚¹æŒæ¡æƒ…å†µ
                    <div class="card-actions">
                        <select id="dashboard-course-select" class="form-select">
                            <option value="">è¯·é€‰æ‹©è¯¾ç¨‹</option>
                        </select>
                        <select class="form-select">
                            <option>æœ¬å‘¨</option>
                            <option>æœ¬æœˆ</option>
                            <option>æœ¬å­¦æœŸ</option>
                        </select>
                        <button class="btn btn-sm btn-accent">
                            <i class="fas fa-download"></i> å¯¼å‡º
                        </button>
                    </div>
                </div>
                <div class="chart-container">
                    <div class="chart-legend">
                        <div><div class="legend-color high"></div> ä¼˜ç§€æŒæ¡ (>80%å­¦ç”Ÿ)</div>
                        <div><div class="legend-color medium"></div> è‰¯å¥½æŒæ¡ (60-80%å­¦ç”Ÿ)</div>
                        <div><div class="legend-color low"></div> éœ€è¦å¼ºåŒ– (<60%å­¦ç”Ÿ)</div>
                    </div>
                    <div class="chart-bars">
                        <div style="text-align: center; padding: 48px 0; color: #7f8c8d;">
                            <i class="fas fa-chart-bar" style="font-size: 48px; margin-bottom: 16px; color: #bdc3c7;"></i>
                            <p>æš‚æ— çŸ¥è¯†ç‚¹æŒæ¡æ•°æ®</p>
                            <p>å®Œæˆè¯¾ç¨‹æµ‹è¯„åè¿™é‡Œä¼šæ˜¾ç¤ºå­¦ç”Ÿçš„çŸ¥è¯†ç‚¹æŒæ¡æƒ…å†µ</p>
                        </div>
                        </div>
                </div>
            </div>
            
            <!-- æœ€æ–°é€šçŸ¥å’Œå¾…åŠäº‹é¡¹çš„ç½‘æ ¼å¸ƒå±€ -->
            <div class="main-content">
                <div class="content-column">
                    <div class="content-card">
                        <div class="card-header">
                            <i class="fas fa-bell"></i> æœ€æ–°é€šçŸ¥
                            <div class="card-actions">
                                <button class="btn btn-sm btn-accent" onclick="showAllTeacherNotices()" id="view-all-notices-btn" style="display: none;">
                                    <i class="fas fa-list"></i> æŸ¥çœ‹å…¨éƒ¨
                                </button>
                            </div>
                        </div>
                        <div id="recent-notices-container">
                            <div style="text-align: center; padding: 48px 0; color: #7f8c8d;">
                                <i class="fas fa-bell-slash" style="font-size: 48px; margin-bottom: 16px; color: #bdc3c7;"></i>
                                <p>æš‚æ— æœ€æ–°é€šçŸ¥</p>
                                <p>å‘å¸ƒé€šçŸ¥åä¼šåœ¨è¿™é‡Œæ˜¾ç¤º</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="content-column">
                    <div class="content-card">
                        <div class="card-header">
                            <i class="fas fa-tasks"></i> å¾…åŠäº‹é¡¹
                            <div class="card-actions">
                                <button class="btn btn-sm btn-primary">
                                    <i class="fas fa-check"></i> å…¨éƒ¨æ ‡è®°
                                </button>
                                </div>
                                </div>
                        <div style="text-align: center; padding: 48px 0; color: #7f8c8d;">
                            <i class="fas fa-check-circle" style="font-size: 48px; margin-bottom: 16px; color: #bdc3c7;"></i>
                            <p>æš‚æ— å¾…åŠäº‹é¡¹</p>
                            <p>åˆ›å»ºè¯¾ç¨‹å’Œå‘å¸ƒæµ‹è¯„åä¼šåœ¨è¿™é‡Œæ˜¾ç¤ºç›¸å…³ä»»åŠ¡</p>
                                </div>
                                </div>
                                </div>
                                </div>
        </section>
        
        <section id="lesson-design" class="main-section hidden-section">
            <div class="content-header"><h1 class="page-title">å¤‡è¯¾ä¸è®¾è®¡</h1></div>
            <div style="padding:2em;">
                <div class="content-card">
                    <div class="card-header">
                        <i class="fas fa-graduation-cap"></i> å¤‡è¯¾ä¸è®¾è®¡
                                </div>
                    <div style="padding: 24px; text-align: center; color: #7f8c8d;">
                        <i class="fas fa-book-open" style="font-size: 48px; margin-bottom: 16px; color: #bdc3c7;"></i>
                        <p>å¤‡è¯¾ä¸è®¾è®¡åŠŸèƒ½æ­£åœ¨å¼€å‘ä¸­...</p>
                        <p>è¯·é€šè¿‡å·¦ä¾§èœå•é€‰æ‹©å…·ä½“åŠŸèƒ½</p>
                    </div>
                </div>
            </div>
        </section>
        
        <section id="my-courses" class="main-section hidden-section">
            <div class="content-header">
                <h1 class="page-title">æˆ‘çš„è¯¾ç¨‹</h1>
                <div class="header-actions">
                    <button class="btn btn-primary" onclick="refreshMyCourses()">
                        <i class="fas fa-sync-alt"></i> åˆ·æ–°åˆ—è¡¨
                    </button>
                    <button class="btn btn-accent" onclick="showCreateCourseModal()">
                        <i class="fas fa-plus"></i> æ–°å»ºè¯¾ç¨‹
                    </button>
                </div>
            </div>
            
            <div class="main-content">
                <div class="content-card">
                    <div class="card-header">
                        <i class="fas fa-list"></i> è¯¾ç¨‹åˆ—è¡¨
                        <div class="card-actions">
                            <input type="text" id="course-search" placeholder="æœç´¢è¯¾ç¨‹..." class="form-input" style="width: 250px; height: 36px;">
                            <select id="course-filter" class="form-select" style="width: 150px; height: 36px;">
                                <option value="">æ‰€æœ‰çŠ¶æ€</option>
                                <option value="active">è¿›è¡Œä¸­</option>
                                <option value="completed">å·²å®Œæˆ</option>
                                <option value="inactive">å·²åœç”¨</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="courses-list-container" id="courses-grid">
                        <!-- è¯¾ç¨‹åˆ—è¡¨å°†åœ¨è¿™é‡ŒåŠ¨æ€åŠ è½½ -->
                        <div style="text-align: center; padding: 48px 0; color: #7f8c8d;">
                            <i class="fas fa-book" style="font-size: 48px; margin-bottom: 16px; color: #bdc3c7;"></i>
                            <p>æš‚æ— è¯¾ç¨‹</p>
                            <p>ç‚¹å‡»"æ–°å»ºè¯¾ç¨‹"å¼€å§‹åˆ›å»ºæ‚¨çš„ç¬¬ä¸€é—¨è¯¾ç¨‹</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <section id="upload-material" class="main-section hidden-section">
            <div class="content-header">
                <h1 class="page-title">æ„å»ºè¯¾ç¨‹çŸ¥è¯†åº“</h1>
                <div class="header-actions">
                    <button class="btn btn-accent" onclick="refreshKnowledgeData()">
                        <i class="fas fa-sync-alt"></i> åˆ·æ–°æ•°æ®
                    </button>
                    <button class="btn btn-primary" onclick="showKnowledgeUploadModal()">
                        <i class="fas fa-plus"></i> ä¸Šä¼ æ–‡æ¡£
                    </button>

                </div>
                        </div>
            
            <!-- çŸ¥è¯†åº“ç»Ÿè®¡æ•°æ®ï¼ˆç‹¬ç«‹æ˜¾ç¤ºï¼‰ -->
            <div class="stats-container">
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-title">çŸ¥è¯†åº“æ•°é‡</div>
                        <div class="stat-icon" style="background-color: rgba(52, 152, 219, 0.1);">
                            <i class="fas fa-database" style="color: var(--primary-color);"></i>
                        </div>
                    </div>
                    <div class="stat-value" id="knowledge-base-count">0</div>
                    <div class="stat-change">
                        <!-- åˆ é™¤ç»¿è‰²æè¿°æ–‡å­— -->
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-title">çŸ¥è¯†å—æ•°é‡</div>
                        <div class="stat-icon" style="background-color: rgba(39, 174, 96, 0.1);">
                            <i class="fas fa-puzzle-piece" style="color: var(--success-color);"></i>
                        </div>
                    </div>
                    <div class="stat-value" id="total-chunks">0</div>
                    <div class="stat-change">
                        <!-- åˆ é™¤ç»¿è‰²æè¿°æ–‡å­— -->
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-title">æ–‡æ¡£æ•°é‡</div>
                        <div class="stat-icon" style="background-color: rgba(142, 68, 173, 0.1);">
                            <i class="fas fa-file-alt" style="color: #8e44ad;"></i>
                        </div>
                    </div>
                    <div class="stat-value" id="total-files">0</div>
                    <div class="stat-change">
                        <!-- åˆ é™¤ç»¿è‰²æè¿°æ–‡å­— -->
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-title">æ€»å¤§å°</div>
                        <div class="stat-icon" style="background-color: rgba(243, 156, 18, 0.1);">
                            <i class="fas fa-hdd" style="color: #f39c12;"></i>
                        </div>
                    </div>
                    <div class="stat-value" id="total-size">0 Bytes</div>
                    <div class="stat-change">
                        <!-- åˆ é™¤ç»¿è‰²æè¿°æ–‡å­— -->
                    </div>
                </div>
                        </div>
            
            <div class="main-content">
                
                <!-- æŒ‰è¯¾ç¨‹åˆ†ç»„çš„çŸ¥è¯†åº“åˆ—è¡¨ -->
                    <div class="content-card">
                        <div class="card-header">
                        <i class="fas fa-database"></i> è¯¾ç¨‹çŸ¥è¯†åº“
                            <div class="card-actions">
                            <select id="knowledge-course-filter" class="form-select" onchange="filterKnowledgeByCourse()" style="margin-right: 10px;">
                                <option value="">å…¨éƒ¨è¯¾ç¨‹</option>
                            </select>
                            <input type="text" id="knowledge-search" class="form-input" placeholder="æœç´¢è¯¾ç¨‹æˆ–æ–‡æ¡£..." style="width: 200px;" oninput="searchKnowledge()">
                        </div>
                    </div>
                    <div id="knowledge-list-container" class="knowledge-carousel-container">
                        <div class="knowledge-carousel-wrapper">
                            <div class="knowledge-carousel-track" id="knowledge-carousel-track">
                                <div class="knowledge-empty-state" style="text-align: center; padding: 48px 0; color: #7f8c8d;">
                                    <i class="fas fa-database" style="font-size: 48px; margin-bottom: 16px; color: #bdc3c7;"></i>
                                    <p>æš‚æ— çŸ¥è¯†åº“æ•°æ®</p>
                                    <p>ä¸Šä¼ æ–‡æ¡£åè¿™é‡Œä¼šæ˜¾ç¤ºçŸ¥è¯†åº“ä¿¡æ¯</p>
                                </div>
                            </div>
                        </div>
                        <div class="knowledge-carousel-indicators" id="knowledge-carousel-indicators" style="display: none;">
                            <!-- åŠ¨æ€ç”ŸæˆæŒ‡ç¤ºå™¨ -->
                        </div>
                    </div>
                </div>

                <!-- æœ€è¿‘ä¸Šä¼ æ–‡æ¡£ -->
                <div class="content-card">
                    <div class="card-header">
                        <i class="fas fa-clock"></i> æœ€è¿‘ä¸Šä¼ æ–‡æ¡£
                        <div class="card-actions">
                            <button class="btn btn-sm btn-accent" onclick="showAllDocuments()">
                                <i class="fas fa-list"></i> æŸ¥çœ‹å…¨éƒ¨
                            </button>
                            </div>
                        </div>
                    <div class="table-container">
                        <table id="recent-documents-table">
                            <thead>
                                <tr>
                                    <th>æ–‡æ¡£åç§°</th>
                                    <th>è¯¾ç¨‹</th>
                                    <th>ä¸Šä¼ æ—¶é—´</th>
                                    <th>çŸ¥è¯†å—æ•°</th>
                                    <th>å¤„ç†çŠ¶æ€</th>
                                    <th>æ“ä½œ</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- åŠ¨æ€åŠ è½½å†…å®¹ -->
                            </tbody>
                        </table>
                                </div>
                                </div>
                                </div>
        </section>
        
        <section id="outline" class="main-section hidden-section">
            <div class="content-header">
                <h1 class="page-title">ç”Ÿæˆæ•™å­¦å¤§çº²</h1>
                <div class="header-actions">
                    <button class="btn btn-accent" onclick="loadOutlineHistory()">
                        <i class="fas fa-folder-open"></i> æˆ‘çš„å¤§çº²
                    </button>
                                </div>
                                </div>
            
            <div class="main-content">
                <!-- AIæ™ºèƒ½ç”Ÿæˆæ•™å­¦å¤§çº²è¾“å…¥å¡ç‰‡ -->
                <div class="content-card">
                    <div class="card-header">
                        <i class="fas fa-brain"></i> åŸºäºRAGæŠ€æœ¯çš„æ™ºèƒ½æ•™å­¦å¤§çº²ç”Ÿæˆ
                        <div style="font-size: 12px; color: #7f8c8d; font-weight: normal; margin-top: 4px;">
                            ğŸ” è‡ªåŠ¨ä»çŸ¥è¯†åº“ä¸­æ£€ç´¢ç›¸å…³å†…å®¹ â†’ ğŸ¤– AIåŸºäºæ£€ç´¢ç»“æœç”Ÿæˆä¸ªæ€§åŒ–å¤§çº²
                        </div>
                                </div>
                    <div style="padding: 24px;">
                        <div style="background: #f8f9fa; padding: 16px; border-radius: 8px; margin-bottom: 20px;">
                            <div style="font-size: 14px; color: #495057; line-height: 1.6;">
                                <i class="fas fa-lightbulb" style="color: #ffc107; margin-right: 8px;"></i> 
                                <strong>RAGæŠ€æœ¯è¯´æ˜ï¼š</strong>ç³»ç»Ÿå°†æ ¹æ®æ‚¨é€‰æ‹©çš„è¯¾ç¨‹å’Œæ•™å­¦è¦æ±‚ï¼Œæ™ºèƒ½æ£€ç´¢è¯¥è¯¾ç¨‹çŸ¥è¯†åº“ä¸­çš„ç›¸å…³å†…å®¹ï¼Œ
                                ç„¶ååŸºäºæ£€ç´¢åˆ°çš„çŸ¥è¯†å—ç”Ÿæˆä¸ªæ€§åŒ–çš„æ•™å­¦å¤§çº²ï¼Œç¡®ä¿å†…å®¹çš„é’ˆå¯¹æ€§å’Œå‡†ç¡®æ€§ã€‚
                            </div>
                        </div>
                        
                        <div style="display: flex; gap: 20px; margin-bottom: 20px;">
                            <div class="form-group" style="flex: 1; margin-bottom: 0;">
                                <label>é€‰æ‹©è¯¾ç¨‹ï¼š<span style="color: #e74c3c;">*</span></label>
                                <select id="outline-course-select" class="form-select">
                                    <option value="">è¯·é€‰æ‹©è¯¾ç¨‹</option>
                                </select>
                                <div style="font-size: 12px; color: #7f8c8d; margin-top: 4px;">
                                    ç³»ç»Ÿå°†è‡ªåŠ¨ä½¿ç”¨è¯¥è¯¾ç¨‹çš„å®Œæ•´çŸ¥è¯†åº“ä½œä¸ºRAGæ£€ç´¢èŒƒå›´
                                </div>
                                </div>
                            <div class="form-group" style="flex: 0 0 200px; margin-bottom: 0;">
                                <label>æ•™å­¦å­¦æ—¶ï¼š<span style="color: #e74c3c;">*</span></label>
                                <input type="number" id="outline-hours" class="form-input" placeholder="è¾“å…¥å­¦æ—¶" min="1" max="100" step="1" title="1å­¦æ—¶ = 45åˆ†é’Ÿ">
                                <div style="font-size: 12px; color: #7f8c8d; margin-top: 4px;">1å­¦æ—¶ = 45åˆ†é’Ÿ</div>
                                </div>
                                </div>
                        
                        <div class="form-group">
                            <label>æ•™å­¦è¦æ±‚ï¼š</label>
                            <textarea id="outline-requirements" class="form-input" rows="3" placeholder="è¯·æè¿°æ‚¨çš„æ•™å­¦è¦æ±‚æˆ–é‡ç‚¹å†…å®¹ï¼ŒRAGç³»ç»Ÿå°†æ®æ­¤ç²¾å‡†æ£€ç´¢ç›¸å…³çŸ¥è¯†..."></textarea>
                            <div style="font-size: 12px; color: #7f8c8d; margin-top: 4px;">
                                ğŸ’¡ æç¤ºï¼šæè¿°è¶Šè¯¦ç»†ï¼ŒRAGæ£€ç´¢çš„ç»“æœè¶Šç²¾å‡†ï¼Œç”Ÿæˆçš„å¤§çº²è¶Šç¬¦åˆæ‚¨çš„éœ€æ±‚
                                </div>
            </div>
                        
                        <div class="form-actions">
                            <button class="btn btn-primary" onclick="generateOutline()">
                                <i class="fas fa-brain"></i> åŸºäºRAGç”Ÿæˆå¤§çº²
                            </button>
                            <button class="btn btn-secondary" onclick="clearOutlineForm()">
                                <i class="fas fa-times"></i> æ¸…ç©ºè¡¨å•
                            </button>
                        </div>
                    </div>
                </div>
        
                <!-- æ•™å­¦å¤§çº²é¢„è§ˆå¡ç‰‡ -->
                <div class="content-card" id="outline-result" style="display: none;">
                    <div id="outline-content">
                        <!-- åŠ¨æ€ç”Ÿæˆçš„æ•™å­¦å¤§çº²å†…å®¹ -->
                    </div>
                </div>
            </div>
        </section>
        
        <section id="publish-notice" class="main-section hidden-section">
            <div class="content-header">
                <h1 class="page-title">å‘å¸ƒé€šçŸ¥</h1>
                <div class="header-actions">
                    <button class="btn btn-accent" onclick="loadNoticeHistory()">
                        <i class="fas fa-history"></i> å†å²é€šçŸ¥
                    </button>
                </div>
            </div>
            
            <div class="main-content">
                <div class="content-card">
                    <div class="card-header">
                        <i class="fas fa-bullhorn"></i> å‘å¸ƒæ–°é€šçŸ¥
                    </div>
                    <div style="padding: 24px;">
                        <div class="form-group">
                            <label>é€šçŸ¥æ ‡é¢˜ï¼š</label>
                            <input type="text" id="notice-title" class="form-input" placeholder="è¯·è¾“å…¥é€šçŸ¥æ ‡é¢˜">
                        </div>
                        
                        <div class="form-group">
                            <label>é€šçŸ¥å†…å®¹ï¼š</label>
                            <textarea id="notice-content" class="form-input" rows="6" placeholder="è¯·è¾“å…¥é€šçŸ¥è¯¦ç»†å†…å®¹..." style="resize: none;"></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label>é€‰æ‹©è¯¾ç¨‹ï¼š<span style="color: #e74c3c;">*</span></label>
                            <select id="notice-target-select" class="form-select">
                                <option value="">è¯·é€‰æ‹©è¯¾ç¨‹</option>
                                <!-- åŠ¨æ€åŠ è½½è¯¾ç¨‹é€‰é¡¹ -->
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>æ¨é€æ—¶é—´ï¼š</label>
                            <select id="notice-push-time" class="form-select" onchange="handlePushTimeChange()">
                                <option value="now">ç«‹å³æ¨é€</option>
                                <option value="scheduled">å®šæ—¶æ¨é€</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>é€‰æ‹©æ¨é€æ—¶é—´ï¼š</label>
                            <input type="datetime-local" id="notice-schedule-time" class="form-input">
                        </div>
                        
                        <div class="form-actions">
                            <button class="btn btn-primary" onclick="publishNotice()">
                                <i class="fas fa-paper-plane"></i> å‘å¸ƒé€šçŸ¥
                            </button>
                            <button class="btn btn-accent" onclick="previewNotice()">
                                <i class="fas fa-eye"></i> é¢„è§ˆ
                            </button>
                            <button class="btn btn-secondary" onclick="clearNoticeForm()">
                                <i class="fas fa-times"></i> æ¸…ç©º
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="content-card">
                    <div class="card-header">
                        <i class="fas fa-list"></i> æœ€è¿‘å‘å¸ƒçš„é€šçŸ¥
                    </div>
                    <div class="table-container">
                        <table id="notices-table">
                            <thead>
                                <tr>
                                    <th>æ ‡é¢˜</th>
                                    <th>å‘å¸ƒæ—¶é—´</th>
                                    <th>è¯¾ç¨‹</th>
                                    <th>çŠ¶æ€</th>
                                    <th>æ“ä½œ</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- åŠ¨æ€åŠ è½½å†…å®¹ -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>
        
        <section id="exam-gen" class="main-section hidden-section">
            <div class="content-header"><h1 class="page-title">è€ƒæ ¸å†…å®¹ç”Ÿæˆ</h1></div>
            <div style="padding:2em;">
                <div class="content-card">
                    <div class="card-header">
                        <i class="fas fa-clipboard-check"></i> è€ƒæ ¸å†…å®¹ç”Ÿæˆ
                    </div>
                    <div style="padding: 24px; text-align: center; color: #7f8c8d;">
                        <i class="fas fa-tasks" style="font-size: 48px; margin-bottom: 16px; color: #bdc3c7;"></i>
                        <p>è€ƒæ ¸å†…å®¹ç”ŸæˆåŠŸèƒ½æ­£åœ¨å¼€å‘ä¸­...</p>
                        <p>è¯·é€šè¿‡å·¦ä¾§èœå•é€‰æ‹©å…·ä½“åŠŸèƒ½</p>
                    </div>
                </div>
            </div>
        </section>
        
        <section id="gen-test" class="main-section hidden-section">
            <div class="content-header">
                <h1 class="page-title">ç”Ÿæˆæµ‹è¯„</h1>
            </div>
            
            <div class="main-content" style="display: flex !important; flex-direction: column !important; grid-template-columns: none !important;">
                <div class="content-card ai-generator-card" style="width: 100% !important; flex: none !important;">
                    <div class="card-header">
                        <i class="fas fa-magic"></i> AIæ™ºèƒ½å‡ºé¢˜
                    </div>
                    <div style="padding: 24px;">
                        <div class="form-group">
                            <label>é€‰æ‹©è¯¾ç¨‹ï¼š<span style="color: #e74c3c;">*</span></label>
                            <select id="exam-course-select" class="form-select" onchange="loadExamCourseMaterials()">
                                <option value="">è¯·é€‰æ‹©è¯¾ç¨‹</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>æµ‹è¯„åç§°ï¼š<span style="color: #e74c3c;">*</span></label>
                            <input type="text" id="exam-title" class="form-input" placeholder="è¯·è¾“å…¥æµ‹è¯„åç§°ï¼Œå¦‚ï¼šæœŸä¸­æµ‹è¯•ã€å•å…ƒæµ‹è¯„ã€ç»¼åˆç»ƒä¹ ç­‰" maxlength="100">
                            <div style="font-size: 12px; color: #7f8c8d; margin-top: 4px;">
                                ğŸ’¡ æç¤ºï¼šå»ºè®®ä½¿ç”¨ç®€æ´æ˜äº†çš„åç§°ï¼Œä¾¿äºå­¦ç”Ÿè¯†åˆ«
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>æ™ºèƒ½å†…å®¹æ£€ç´¢ï¼š</label>
                            <div class="rag-info-box" style="background-color: #f8f9fa; border: 1px solid #e9ecef; padding: 16px; border-radius: 8px; margin-bottom: 16px;">
                                <div style="display: flex; align-items: center; margin-bottom: 8px;">
                                    <i class="fas fa-brain" style="color: #007bff; margin-right: 8px;"></i>
                                    <strong style="color: #495057;">RAGæ™ºèƒ½æ£€ç´¢æŠ€æœ¯</strong>
                            </div>
                                <p style="margin: 0; color: #6c757d; font-size: 14px; line-height: 1.4;">
                                    ç³»ç»Ÿå°†æ ¹æ®æ‚¨è®¾ç½®çš„é¢˜å‹å’Œè¦æ±‚ï¼Œè‡ªåŠ¨ä»è¯¾ç¨‹çŸ¥è¯†åº“ä¸­æ™ºèƒ½æ£€ç´¢æœ€ç›¸å…³çš„å†…å®¹æ¥ç”Ÿæˆæµ‹è¯„ã€‚
                                    <br>æ— éœ€æ‰‹åŠ¨é€‰æ‹©å…·ä½“èµ„æ–™ï¼ŒAIä¼šè‡ªåŠ¨åŒ¹é…æœ€é€‚åˆçš„çŸ¥è¯†ç‚¹è¿›è¡Œæµ‹è¯„ç”Ÿæˆã€‚
                                </p>
                                <div style="margin-top: 8px; padding-top: 8px; border-top: 1px solid #e9ecef; font-size: 12px; color: #868e96;">
                                    <i class="fas fa-lightbulb" style="margin-right: 4px;"></i>
                                    RAGæŠ€æœ¯å°†å¯¹æ‚¨çš„éœ€æ±‚è¿›è¡Œå‘é‡åŒ–ï¼Œå¹¶ä»çŸ¥è¯†åº“ä¸­æ£€ç´¢åŒ¹é…åº¦æœ€é«˜çš„å†…å®¹å—
                                    </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>é¢˜å‹è®¾ç½®ï¼š<span style="color: #e74c3c;">*</span></label>
                            <div class="question-types-config">
                                <div class="question-type-item">
                                    <label>
                                        <input type="checkbox" id="q-multiple-choice">
                                        <span>ğŸ“ é€‰æ‹©é¢˜</span>
                                    </label>
                                    <div style="display: flex; align-items: center; gap: 8px;">
                                        <input type="number" id="q-multiple-choice-count" class="form-input-sm" placeholder="0" min="0" max="100" style="width: 70px;">
                                        <span>é¢˜</span>
                                        <span style="color: #6c757d;">Ã—</span>
                                        <input type="number" id="q-multiple-choice-score" class="form-input-sm" placeholder="5" min="1" max="50" style="width: 70px;">
                                        <span style="color: #6c757d;">åˆ†/é¢˜</span>
                                    </div>
                                </div>
                                <div class="question-type-item">
                                    <label>
                                        <input type="checkbox" id="q-fill-blank">
                                        <span>âœï¸ å¡«ç©ºé¢˜</span>
                                    </label>
                                    <div style="display: flex; align-items: center; gap: 8px;">
                                        <input type="number" id="q-fill-blank-count" class="form-input-sm" placeholder="0" min="0" max="100" style="width: 70px;">
                                        <span>é¢˜</span>
                                        <span style="color: #6c757d;">Ã—</span>
                                        <input type="number" id="q-fill-blank-score" class="form-input-sm" placeholder="8" min="1" max="50" style="width: 70px;">
                                        <span style="color: #6c757d;">åˆ†/é¢˜</span>
                                    </div>
                                </div>
                                <div class="question-type-item">
                                    <label>
                                        <input type="checkbox" id="q-true-false">
                                        <span>âœ… åˆ¤æ–­é¢˜</span>
                                    </label>
                                    <div style="display: flex; align-items: center; gap: 8px;">
                                        <input type="number" id="q-true-false-count" class="form-input-sm" placeholder="0" min="0" max="100" style="width: 70px;">
                                        <span>é¢˜</span>
                                        <span style="color: #6c757d;">Ã—</span>
                                        <input type="number" id="q-true-false-score" class="form-input-sm" placeholder="3" min="1" max="30" style="width: 70px;">
                                        <span style="color: #6c757d;">åˆ†/é¢˜</span>
                                    </div>
                                </div>
                                <div class="question-type-item">
                                    <label>
                                        <input type="checkbox" id="q-answer">
                                        <span>ğŸ“ è§£ç­”é¢˜</span>
                                    </label>
                                    <div style="display: flex; align-items: center; gap: 8px;">
                                        <input type="number" id="q-answer-count" class="form-input-sm" placeholder="0" min="0" max="50" style="width: 70px;">
                                        <span>é¢˜</span>
                                        <span style="color: #6c757d;">Ã—</span>
                                        <input type="number" id="q-answer-score" class="form-input-sm" placeholder="15" min="5" max="100" style="width: 70px;">
                                        <span style="color: #6c757d;">åˆ†/é¢˜</span>
                                    </div>
                                </div>
                                <div class="question-type-item assignment-type">
                                    <label>
                                        <input type="checkbox" id="q-assignment">
                                        <span>ğŸ“‹ å¤§ä½œä¸š</span>
                                        <span class="new-feature-badge">AIæ™ºèƒ½</span>
                                    </label>
                                    <div style="display: flex; align-items: center; gap: 8px;">
                                        <input type="number" id="q-assignment-count" class="form-input-sm" placeholder="1" min="1" max="5" value="1" style="width: 70px;">
                                        <span>é¢˜</span>
                                        <span style="color: #6c757d;">Ã—</span>
                                        <input type="number" id="q-assignment-score" class="form-input-sm" placeholder="50" min="20" max="100" style="width: 70px;">
                                        <span style="color: #6c757d;">åˆ†/é¢˜</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- è‡ªå®šä¹‰é¢˜å‹ -->
                            <div class="custom-question-type">
                                <div class="custom-question-item" style="display: flex; flex-wrap: wrap; align-items: center; gap: 12px; padding: 12px; border: 1px solid #e9ecef; border-radius: 8px; background-color: #f8f9fa;">
                                    <label style="display: flex; align-items: center; gap: 8px; flex-shrink: 0;">
                                        <input type="checkbox" id="q-custom">
                                        <span style="font-weight: 500;">ğŸ¯ è‡ªå®šä¹‰é¢˜å‹</span>
                                    </label>
                                    <input type="text" id="q-custom-requirement" class="form-input-custom" 
                                           placeholder="å¦‚ï¼šæ¡ˆä¾‹åˆ†æé¢˜ã€å®æ“é¢˜ã€ç»¼åˆåº”ç”¨é¢˜ã€ç¼–ç¨‹é¢˜ç­‰..." 
                                           style="flex: 1; min-width: 200px; max-width: 300px;">
                                    <div style="display: flex; align-items: center; gap: 8px; flex-shrink: 0;">
                                        <input type="number" id="q-custom-count" class="form-input-sm" placeholder="0" min="0" max="50" style="width: 70px;">
                                        <span>é¢˜</span>
                                        <span style="color: #6c757d;">Ã—</span>
                                        <input type="number" id="q-custom-score" class="form-input-sm" placeholder="20" min="5" max="100" style="width: 70px;">
                                        <span style="color: #6c757d;">åˆ†/é¢˜</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- èƒ½åŠ›åŸ¹å…»å¯¼å‘è®¾ç½® -->
                        <div class="form-group">
                            <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 12px; padding: 16px; margin-bottom: 16px;">
                                <label style="display: flex; align-items: center; gap: 12px; color: white; margin: 0; cursor: pointer;">
                                    <input type="checkbox" id="enable-capability-analysis" onchange="toggleCapabilitySettings()" 
                                           style="width: 18px; height: 18px; accent-color: #fff;">
                                    <div style="display: flex; align-items: center; gap: 8px;">
                                        <i class="fas fa-graduation-cap" style="font-size: 18px;"></i>
                                        <span style="font-size: 16px; font-weight: 600;">èƒ½åŠ›åŸ¹å…»å¯¼å‘å‡ºé¢˜</span>
                                        <span style="font-size: 12px; background: rgba(255,255,255,0.2); padding: 2px 8px; border-radius: 10px;">æ™ºèƒ½AI</span>
                                    </div>
                                    <i class="fas fa-info-circle" title="åŸºäºäººæ‰åŸ¹å…»ç›®æ ‡ï¼Œä¸ºæ¯é“é¢˜ç›®æ˜ç¡®èƒ½åŠ›è€ƒæ ¸ç»´åº¦" 
                                       style="margin-left: auto; color: rgba(255,255,255,0.8); cursor: help;"></i>
                                </label>
                                <div style="font-size: 13px; color: rgba(255,255,255,0.9); margin-top: 8px; line-height: 1.4;">
                                    å¯ç”¨åå°†æ ¹æ®èƒ½åŠ›ç»´åº¦æ™ºèƒ½ç”Ÿæˆé¢˜ç›®ï¼Œé‡ç‚¹è€ƒæŸ¥å­¦ç”Ÿçš„ç†è®ºæŒæ¡ã€å®è·µåº”ç”¨ã€åˆ›æ–°æ€ç»´ç­‰æ ¸å¿ƒèƒ½åŠ›
                                </div>
                            </div>
                            
                            <div id="capability-settings" style="display: none;">
                                <div style="background: #fff; border: 2px solid #e3f2fd; border-radius: 12px; padding: 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                                    <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 16px; color: #1976d2;">
                                        <i class="fas fa-cogs" style="font-size: 16px;"></i>
                                        <span style="font-weight: 600; font-size: 15px;">èƒ½åŠ›ç»´åº¦é…ç½®</span>
                                        <div style="flex: 1; height: 1px; background: linear-gradient(to right, #1976d2, transparent); margin-left: 12px;"></div>
                                    </div>
                                    
                                    <style>
                                        .capability-grid {
                                            display: flex;
                                            flex-wrap: wrap;
                                            gap: 16px;
                                            justify-content: flex-start;
                                        }
                                        .capability-card {
                                            flex: 1 1 calc(33.333% - 12px);
                                            min-width: 300px;
                                            max-width: 400px;
                                            border-radius: 12px;
                                            padding: 20px;
                                            box-shadow: 0 3px 12px rgba(0,0,0,0.1);
                                            transition: all 0.3s ease;
                                            display: flex;
                                            flex-direction: column;
                                            justify-content: space-between;
                                            height: auto;
                                        }
                                        .capability-card:hover {
                                            transform: translateY(-3px);
                                            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
                                        }
                                        .capability-header {
                                            display: flex;
                                            align-items: center;
                                            justify-content: space-between;
                                            margin-bottom: 12px;
                                        }
                                        .capability-info {
                                            flex: 1;
                                            min-width: 0;
                                        }
                                        .capability-title {
                                            font-size: 16px;
                                            font-weight: 600;
                                            margin: 0;
                                            line-height: 1.3;
                                            color: #2c3e50;
                                            display: flex;
                                            align-items: center;
                                            gap: 8px;
                                        }
                                        .capability-desc {
                                            font-size: 12px;
                                            line-height: 1.4;
                                            color: #6c757d;
                                            margin-top: 6px;
                                        }
                                        .capability-input-section {
                                            display: flex;
                                            align-items: center;
                                            gap: 10px;
                                            margin-left: 16px;
                                            flex-shrink: 0;
                                        }
                                        .capability-input {
                                            width: 80px;
                                            height: 36px;
                                            text-align: center;
                                            border: 2px solid #e9ecef;
                                            border-radius: 6px;
                                            font-size: 14px;
                                            font-weight: 600;
                                            transition: all 0.3s ease;
                                        }
                                        .capability-input:focus {
                                            outline: none;
                                            border-color: #007bff;
                                            box-shadow: 0 0 0 0.2rem rgba(0,123,255,.25);
                                        }
                                        .capability-unit {
                                            font-size: 13px;
                                            color: #6c757d;
                                            font-weight: 500;
                                        }
                                        @media (max-width: 1200px) {
                                            .capability-card { flex: 1 1 calc(50% - 8px); min-width: 280px; }
                                        }
                                        @media (max-width: 768px) {
                                            .capability-card { flex: 1 1 100%; min-width: 250px; }
                                        }
                                    </style>
                                    <div class="capability-grid">
                                        <!-- ç†è®ºæŒæ¡ -->
                                        <div class="capability-card" style="border: 1px solid #e1f5fe; background: linear-gradient(135deg, #e1f5fe 0%, #f3e5f5 100%);">
                                            <div class="capability-header">
                                                <div class="capability-info">
                                                    <label style="cursor: pointer; display: block;">
                                                        <input type="checkbox" id="cap-knowledge" value="knowledge" style="accent-color: #1976d2; margin-right: 10px; vertical-align: middle; position: relative; top: 7px;">
                                                        <h4 class="capability-title" style="color: #0d47a1; display: inline;">
                                                            ğŸ“š ç†è®ºæŒæ¡
                                                        </h4>
                                                    </label>
                                                    <div class="capability-desc">åŸºç¡€çŸ¥è¯†ç†è§£ã€æ¦‚å¿µæŒæ¡</div>
                                                </div>
                                                <div class="capability-input-section">
                                                    <input type="number" id="cap-knowledge-count" class="capability-input" placeholder="0" min="0" max="50">
                                                    <span class="capability-unit">é¢˜</span>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- å®è·µåº”ç”¨ -->
                                        <div class="capability-card" style="border: 1px solid #e8f5e8; background: linear-gradient(135deg, #e8f5e8 0%, #fff3e0 100%);">
                                            <div class="capability-header">
                                                <div class="capability-info">
                                                    <label style="cursor: pointer; display: block;">
                                                        <input type="checkbox" id="cap-application" value="application" style="accent-color: #2e7d32; margin-right: 10px; vertical-align: middle; position: relative; top: 7px;">
                                                        <h4 class="capability-title" style="color: #1b5e20; display: inline;">
                                                            ğŸ”§ å®è·µåº”ç”¨
                                                        </h4>
                                                    </label>
                                                    <div class="capability-desc">å®é™…æ“ä½œã€é—®é¢˜è§£å†³</div>
                                                </div>
                                                <div class="capability-input-section">
                                                    <input type="number" id="cap-application-count" class="capability-input" placeholder="0" min="0" max="50">
                                                    <span class="capability-unit">é¢˜</span>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- åˆ›æ–°æ€ç»´ -->
                                        <div class="capability-card" style="border: 1px solid #fff3e0; background: linear-gradient(135deg, #fff3e0 0%, #fce4ec 100%);">
                                            <div class="capability-header">
                                                <div class="capability-info">
                                                    <label style="cursor: pointer; display: block;">
                                                        <input type="checkbox" id="cap-innovation" value="innovation" style="accent-color: #f57c00; margin-right: 10px; vertical-align: middle; position: relative; top: 7px;">
                                                        <h4 class="capability-title" style="color: #e65100; display: inline;">
                                                            ğŸ’¡ åˆ›æ–°æ€ç»´
                                                        </h4>
                                                    </label>
                                                    <div class="capability-desc">å‘æ•£æ€ç»´ã€åˆ›é€ æ€§è§£å†³é—®é¢˜</div>
                                                </div>
                                                <div class="capability-input-section">
                                                    <input type="number" id="cap-innovation-count" class="capability-input" placeholder="0" min="0" max="50">
                                                    <span class="capability-unit">é¢˜</span>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- çŸ¥è¯†è¿ç§» -->
                                        <div class="capability-card" style="border: 1px solid #f3e5f5; background: linear-gradient(135deg, #f3e5f5 0%, #e8eaf6 100%);">
                                            <div class="capability-header">
                                                <div class="capability-info">
                                                    <label style="cursor: pointer; display: block;">
                                                        <input type="checkbox" id="cap-transfer" value="transfer" style="accent-color: #7b1fa2; margin-right: 10px; vertical-align: middle; position: relative; top: 7px;">
                                                        <h4 class="capability-title" style="color: #4a148c; display: inline;">
                                                            ğŸ”„ çŸ¥è¯†è¿ç§»
                                                        </h4>
                                                    </label>
                                                    <div class="capability-desc">è·¨é¢†åŸŸåº”ç”¨ã€ä¸¾ä¸€åä¸‰</div>
                                                </div>
                                                <div class="capability-input-section">
                                                    <input type="number" id="cap-transfer-count" class="capability-input" placeholder="0" min="0" max="50">
                                                    <span class="capability-unit">é¢˜</span>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- å­¦ä¹ èƒ½åŠ› -->
                                        <div class="capability-card" style="border: 1px solid #e0f2f1; background: linear-gradient(135deg, #e0f2f1 0%, #e8f5e8 100%);">
                                            <div class="capability-header">
                                                <div class="capability-info">
                                                    <label style="cursor: pointer; display: block;">
                                                        <input type="checkbox" id="cap-learning" value="learning" style="accent-color: #00695c; margin-right: 10px; vertical-align: middle; position: relative; top: 7px;">
                                                        <h4 class="capability-title" style="color: #004d40; display: inline;">
                                                            ğŸ“ˆ å­¦ä¹ èƒ½åŠ›
                                                        </h4>
                                                    </label>
                                                    <div class="capability-desc">è‡ªä¸»å­¦ä¹ ã€å­¦ä¹ ç­–ç•¥</div>
                                                </div>
                                                <div class="capability-input-section">
                                                    <input type="number" id="cap-learning-count" class="capability-input" placeholder="0" min="0" max="50">
                                                    <span class="capability-unit">é¢˜</span>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- ç³»ç»Ÿæ€ç»´ -->
                                        <div class="capability-card" style="border: 1px solid #e3f2fd; background: linear-gradient(135deg, #e3f2fd 0%, #e1f5fe 100%);">
                                            <div class="capability-header">
                                                <div class="capability-info">
                                                    <label style="cursor: pointer; display: block;">
                                                        <input type="checkbox" id="cap-systematic" value="systematic" style="accent-color: #1565c0; margin-right: 10px; vertical-align: middle; position: relative; top: 7px;">
                                                        <h4 class="capability-title" style="color: #0d47a1; display: inline;">
                                                            ğŸŒ ç³»ç»Ÿæ€ç»´
                                                        </h4>
                                                    </label>
                                                    <div class="capability-desc">æ•´ä½“æŠŠæ¡ã€ç³»ç»Ÿåˆ†æ</div>
                                                </div>
                                                <div class="capability-input-section">
                                                    <input type="number" id="cap-systematic-count" class="capability-input" placeholder="0" min="0" max="50">
                                                    <span class="capability-unit">é¢˜</span>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- æ€æ”¿ç´ å…» -->
                                        <div class="capability-card" style="border: 1px solid #ffebee; background: linear-gradient(135deg, #ffebee 0%, #fce4ec 100%);">
                                            <div class="capability-header">
                                                <div class="capability-info">
                                                    <label style="cursor: pointer; display: block;">
                                                        <input type="checkbox" id="cap-ideology" value="ideology" style="accent-color: #c62828; margin-right: 10px; vertical-align: middle; position: relative; top: 7px;">
                                                        <h4 class="capability-title" style="color: #b71c1c; display: inline;">
                                                            ğŸ¯ æ€æ”¿ç´ å…»
                                                        </h4>
                                                    </label>
                                                    <div class="capability-desc">ä»·å€¼è§‚å¿µã€ç¤¾ä¼šè´£ä»»æ„Ÿ</div>
                                                </div>
                                                <div class="capability-input-section">
                                                    <input type="number" id="cap-ideology-count" class="capability-input" placeholder="0" min="0" max="50">
                                                    <span class="capability-unit">é¢˜</span>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- æ²Ÿé€šåä½œ -->
                                        <div class="capability-card" style="border: 1px solid #f9fbe7; background: linear-gradient(135deg, #f9fbe7 0%, #f0f4c3 100%);">
                                            <div class="capability-header">
                                                <div class="capability-info">
                                                    <label style="cursor: pointer; display: block;">
                                                        <input type="checkbox" id="cap-communication" value="communication" style="accent-color: #689f38; margin-right: 10px; vertical-align: middle; position: relative; top: 7px;">
                                                        <h4 class="capability-title" style="color: #33691e; display: inline;">
                                                            ğŸ¤ æ²Ÿé€šåä½œ
                                                        </h4>
                                                    </label>
                                                    <div class="capability-desc">è¡¨è¾¾èƒ½åŠ›ã€å›¢é˜Ÿåˆä½œ</div>
                                                </div>
                                                <div class="capability-input-section">
                                                    <input type="number" id="cap-communication-count" class="capability-input" placeholder="0" min="0" max="50">
                                                    <span class="capability-unit">é¢˜</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div style="margin-top: 20px; padding: 14px; background: linear-gradient(135deg, #e8f5e8 0%, #e3f2fd 100%); border-radius: 8px; border-left: 4px solid #2196f3;">
                                        <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                                            <i class="fas fa-robot" style="color: #1976d2; font-size: 16px;"></i>
                                            <span style="font-weight: 600; color: #1976d2; font-size: 14px;">AIæ™ºèƒ½å»ºè®®</span>
                                        </div>
                                        <div style="font-size: 13px; color: #37474f; line-height: 1.5;">
                                            <strong>æ¨èæƒé‡åˆ†é…ï¼š</strong>å®è·µåº”ç”¨25% â€¢ ç†è®ºæŒæ¡20% â€¢ åˆ›æ–°æ€ç»´15% â€¢ çŸ¥è¯†è¿ç§»15% â€¢ å­¦ä¹ èƒ½åŠ›10% â€¢ ç³»ç»Ÿæ€ç»´10% â€¢ å…¶ä»–5%
                                        </div>
                                        <div style="margin-top: 8px;">
                                            <button type="button" onclick="setRecommendedCapabilityValues()" 
                                                    style="background: #1976d2; color: white; border: none; padding: 6px 12px; border-radius: 4px; font-size: 12px; cursor: pointer;">
                                                <i class="fas fa-magic"></i> ä¸€é”®åº”ç”¨æ¨èé…ç½®
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>éš¾åº¦åˆ†å¸ƒï¼š<span style="color: #e74c3c;">*</span></label>
                            <div class="difficulty-config">
                                <div class="difficulty-item">
                                    <label>ç®€å•ï¼š</label>
                                    <input type="range" id="difficulty-easy" min="0" max="100" value="30">
                                    <input type="number" id="difficulty-easy-input" class="difficulty-input" min="0" max="100" value="30">
                                    <span>%</span>
                                </div>
                                <div class="difficulty-item">
                                    <label>ä¸­ç­‰ï¼š</label>
                                    <input type="range" id="difficulty-medium" min="0" max="100" value="50">
                                    <input type="number" id="difficulty-medium-input" class="difficulty-input" min="0" max="100" value="50">
                                    <span>%</span>
                                </div>
                                <div class="difficulty-item">
                                    <label>å›°éš¾ï¼š</label>
                                    <input type="range" id="difficulty-hard" min="0" max="100" value="20">
                                    <input type="number" id="difficulty-hard-input" class="difficulty-input" min="0" max="100" value="20">
                                    <span>%</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-row" style="display: flex; gap: 24px; align-items: flex-end;">
                            <div class="form-group" style="flex: 1; margin-bottom: 0;">
                            <label>è€ƒè¯•æ—¶é•¿ï¼š<span style="color: #e74c3c;">*</span></label>
                                <div style="display: flex; align-items: center; gap: 8px;">
                            <input type="number" id="exam-duration" class="form-input" value="90" min="30" max="180">
                                    <span style="white-space: nowrap; display: inline-block;">åˆ†é’Ÿ</span>
                                </div>
                        </div>
                        
                            <div class="form-group" style="flex: 1; margin-bottom: 0;">
                            <label>æ€»åˆ†è®¾ç½®ï¼š<span style="color: #e74c3c;">*</span></label>
                                <div style="display: flex; align-items: center; gap: 8px;">
                            <input type="number" id="exam-total-score" class="form-input" value="100" min="50" max="200">
                                    <span style="white-space: nowrap; display: inline-block;">åˆ†</span>
                                    <button type="button" onclick="autoCalculateTotalScore()" class="btn btn-sm" 
                                            style="background: #17a2b8; color: white; border: none; padding: 4px 8px; border-radius: 4px; font-size: 12px; white-space: nowrap;"
                                            title="æ ¹æ®é¢˜å‹åˆ†æ•°è‡ªåŠ¨è®¡ç®—æ€»åˆ†">
                                        <i class="fas fa-calculator"></i> è‡ªåŠ¨è®¡ç®—
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label>ç‰¹æ®Šè¦æ±‚ï¼š<span style="color: #999; font-size: 12px;">ï¼ˆå¯é€‰ï¼‰</span></label>
                            <textarea id="exam-special-requirements" class="form-input" 
                                placeholder="å¦‚ï¼šé‡ç‚¹è€ƒå¯Ÿç†è®ºåº”ç”¨èƒ½åŠ›ã€å¢åŠ å®é™…æ¡ˆä¾‹åˆ†æã€æ³¨é‡è®¡ç®—é¢˜çš„æ­¥éª¤å±•ç¤ºç­‰..." 
                                rows="3" style="resize: vertical;"></textarea>
                        </div>
                        
                        <div class="form-actions">
                            <button class="btn btn-primary" onclick="generateExam()">
                                <i class="fas fa-magic"></i> ç”Ÿæˆè¯•å·
                            </button>
                            <button class="btn btn-secondary" onclick="clearExamForm()">
                                <i class="fas fa-times"></i> æ¸…ç©ºè®¾ç½®
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="content-card" id="exam-preview" style="display: none; width: 100% !important; flex: none !important;">
                    <div class="card-header">
                        <i class="fas fa-file-alt"></i> è¯•å·é¢„è§ˆ
                        <div class="card-actions">
                            <button class="btn btn-sm btn-accent" onclick="editExam()">
                                <i class="fas fa-edit"></i> ç¼–è¾‘
                            </button>
                            <button class="btn btn-sm btn-secondary" onclick="exportExam()">
                                <i class="fas fa-download"></i> å¯¼å‡º
                            </button>
                        </div>
                    </div>
                    <div id="exam-content" style="padding: 24px;">
                        <!-- åŠ¨æ€ç”Ÿæˆçš„è¯•å·å†…å®¹ -->
                    </div>
                </div>
            </div>
        </section>
        
        <section id="test-manage" class="main-section hidden-section">
            <div class="content-header">
                <h1 class="page-title">æµ‹è¯„ç®¡ç†</h1>
                <div class="header-actions">
                    <button class="btn btn-primary" onclick="loadExamManageData()">
                        <i class="fas fa-sync-alt"></i> åˆ·æ–°æ•°æ®
                    </button>
                    <button class="btn btn-accent" onclick="showScheduleModal()">
                        <i class="fas fa-calendar-plus"></i> å®šæ—¶å‘å¸ƒ
                    </button>
                </div>
            </div>
            
            <!-- è€ƒè¯•ç»Ÿè®¡æ¨¡å— - å‚è€ƒæ§åˆ¶é¢æ¿æ ·å¼ -->
                        <div class="stats-container">
                            <div class="stat-card">
                                <div class="stat-header">
                                    <div class="stat-title">å¾…å‘å¸ƒè¯•å·</div>
                                    <div class="stat-icon" style="background-color: rgba(52, 152, 219, 0.1);">
                                        <i class="fas fa-file-alt" style="color: var(--primary-color);"></i>
                                    </div>
                                </div>
                                <div class="stat-value" id="stat-draft-exams">0</div>
                            </div>
                            
                            <div class="stat-card">
                                <div class="stat-header">
                                    <div class="stat-title">è¿›è¡Œä¸­è€ƒè¯•</div>
                                    <div class="stat-icon" style="background-color: rgba(39, 174, 96, 0.1);">
                                        <i class="fas fa-play-circle" style="color: var(--success-color);"></i>
                                    </div>
                                </div>
                                <div class="stat-value" id="stat-ongoing-exams">0</div>
                            </div>
                            
                            <div class="stat-card">
                                <div class="stat-header">
                                    <div class="stat-title">å·²ç»“æŸè€ƒè¯•</div>
                                    <div class="stat-icon" style="background-color: rgba(155, 89, 182, 0.1);">
                                        <i class="fas fa-check-circle" style="color: #9b59b6;"></i>
                                    </div>
                                </div>
                                <div class="stat-value" id="stat-pending-grades">0</div>
                            </div>
                            
                            <div class="stat-card">
                                <div class="stat-header">
                                    <div class="stat-title">æœ¬æœˆè€ƒè¯•æ•°</div>
                                    <div class="stat-icon" style="background-color: rgba(26, 188, 156, 0.1);">
                                        <i class="fas fa-calendar" style="color: var(--accent-color);"></i>
                                    </div>
                                </div>
                                <div class="stat-value" id="stat-monthly-exams">0</div>
                            </div>
                        </div>
            
            <!-- è¯•å·åˆ—è¡¨æ¨¡å— - ç‹¬ç«‹æˆè¡Œ -->
            <div class="content-card" style="margin-top: 24px;">
                <div class="card-header">
                    <i class="fas fa-list"></i> è¯•å·åˆ—è¡¨
                    <div class="card-actions">
                        <select id="exam-status-filter" class="form-select" onchange="filterExamsByStatus()">
                            <option value="">æ‰€æœ‰çŠ¶æ€</option>
                            <option value="DRAFT">è‰ç¨¿</option>
                            <option value="PUBLISHED">å·²å‘å¸ƒ</option>
                            <option value="ONGOING">è¿›è¡Œä¸­</option>
                            <option value="FINISHED">å·²ç»“æŸ</option>
                        </select>
                        <input type="text" id="exam-search-input" class="form-input" placeholder="è¾“å…¥è¯•å·åç§°ã€è¯¾ç¨‹åç§°æˆ–ç±»å‹..." 
                               onkeypress="if(event.key==='Enter') searchExams()" style="width: 250px;">
                        <button class="btn btn-accent" onclick="searchExams()">
                            <i class="fas fa-search"></i>
                        </button>
                        <button class="btn btn-secondary" onclick="loadExamList()" title="åˆ·æ–°è¯•å·åˆ—è¡¨">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>
                </div>
                
                <div class="table-container">
                    <table id="exams-table">
                        <thead>
                            <tr>
                                <th>è¯•å·åç§°</th>
                                <th>é¢˜ç›®æ•°é‡</th>
                                <th>è€ƒè¯•æ—¶é•¿</th>
                                <th>çŠ¶æ€</th>
                                <th>å‚ä¸äººæ•°</th>
                                <th>å‘å¸ƒæ—¶é—´</th>
                                <th>æ€»åˆ†</th>
                                <th>æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- åŠ¨æ€åŠ è½½å†…å®¹ -->
                        </tbody>
                    </table>
                </div>
            </div>
        </section>
        

        
        <section id="grade-mark" class="main-section hidden-section">
            <div class="content-header">
                <h1 class="page-title">æˆç»©æ‰¹æ”¹</h1>
                <div class="header-actions">
                    <button class="btn btn-primary" onclick="loadGradeList()">
                        <i class="fas fa-sync-alt"></i> åˆ·æ–°
                    </button>
                    <button class="btn btn-accent" onclick="autoGradeAll()">
                        <i class="fas fa-brain"></i> DeepSeekæ™ºèƒ½è¯„åˆ†
                    </button>
                    <button class="btn btn-success" onclick="publishSelectedExamGrades()">
                        <i class="fas fa-paper-plane"></i> å‘å¸ƒæˆç»©
                    </button>
                </div>
            </div>
            
            <div class="main-content">
                <div class="content-card">
                    <div class="card-header">
                        <i class="fas fa-marker"></i> å¾…æ‰¹æ”¹è¯•å·
                        <div class="card-actions">
                            <select id="grade-student-filter" class="form-select" onchange="filterGrades()">
                                <option value="">æ‰€æœ‰å­¦ç”Ÿ</option>
                            </select>
                            <select id="grade-exam-filter" class="form-select" onchange="filterGrades()">
                                <option value="">æ‰€æœ‰è€ƒè¯•</option>
                            </select>
                            <select id="grade-status-filter" class="form-select" onchange="filterGrades()">
                                <option value="">æ‰€æœ‰çŠ¶æ€</option>
                                <option value="PENDING">å¾…æ‰¹æ”¹</option>
                                <option value="AI_GRADED">AIå·²æ‰¹æ”¹</option>
                                <option value="MANUAL_GRADED">äººå·¥å·²æ‰¹æ”¹</option>
                            </select>
                            <button class="btn btn-secondary" onclick="resetGradeFilters()" title="é‡ç½®ç­›é€‰" style="height: 40px; display: flex; align-items: center; white-space: nowrap;">
                                <i class="fas fa-undo" style="margin-right: 6px;"></i>é‡ç½®
                            </button>
                        </div>
                    </div>
                    <div class="table-container">
                        <table id="grades-table">
                            <thead>
                                <tr>
                                    <th style="width: 50px;">
                                        <input type="checkbox" id="select-all-grades" onchange="toggleAllGrades()" style="transform: scale(1.2);">
                                    </th>
                                    <th>å­¦ç”Ÿå§“å</th>
                                    <th>è€ƒè¯•åç§°</th>
                                    <th>æäº¤æ—¶é—´</th>
                                    <th>AIè¯„åˆ†</th>
                                    <th>æœ€ç»ˆå¾—åˆ†</th>
                                    <th>æ‰¹æ”¹çŠ¶æ€</th>
                                    <th>æ“ä½œ</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- åŠ¨æ€åŠ è½½å†…å®¹ -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>
        
        <section id="grade-analysis" class="main-section hidden-section">
            <div class="content-header">
                <h1 class="page-title">æˆç»©åˆ†æ</h1>
                <div class="header-actions">
                    <select id="analysis-exam-select" class="form-select" onchange="loadSelectedExamAnalysis()">
                        <option value="">é€‰æ‹©è€ƒè¯•</option>
                    </select>
                    <button class="btn btn-accent" onclick="exportAnalysisReport()" style="white-space: nowrap;">
                        <i class="fas fa-download"></i>&nbsp;å¯¼å‡ºæŠ¥å‘Š
                    </button>
                </div>
            </div>
            
            <!-- ç¬¬ä¸€è¡Œï¼šç»Ÿè®¡æ•°æ®å¡ç‰‡ -->
                        <div class="stats-container">
                            <div class="stat-card">
                                <div class="stat-header">
                                    <div class="stat-title">å¹³å‡åˆ†</div>
                                    <div class="stat-icon" style="background-color: rgba(52, 152, 219, 0.1);">
                                        <i class="fas fa-calculator" style="color: var(--primary-color);"></i>
                                    </div>
                                </div>
                                <div class="stat-value" id="analysis-avg-score">--</div>
                            </div>
                            
                            <div class="stat-card">
                                <div class="stat-header">
                                    <div class="stat-title">æœ€é«˜åˆ†</div>
                                    <div class="stat-icon" style="background-color: rgba(39, 174, 96, 0.1);">
                                        <i class="fas fa-trophy" style="color: var(--success-color);"></i>
                                    </div>
                                </div>
                                <div class="stat-value" id="analysis-max-score">--</div>
                            </div>
                            
                            <div class="stat-card">
                                <div class="stat-header">
                                    <div class="stat-title">åŠæ ¼ç‡</div>
                                    <div class="stat-icon" style="background-color: rgba(26, 188, 156, 0.1);">
                                        <i class="fas fa-percentage" style="color: var(--accent-color);"></i>
                                    </div>
                                </div>
                                <div class="stat-value" id="analysis-pass-rate">--%</div>
                            </div>
                            
                            <div class="stat-card">
                                <div class="stat-header">
                                    <div class="stat-title">æ ‡å‡†å·®</div>
                                    <div class="stat-icon" style="background-color: rgba(243, 156, 18, 0.1);">
                                        <i class="fas fa-chart-line" style="color: var(--warning-color);"></i>
                                    </div>
                                </div>
                                <div class="stat-value" id="analysis-std-dev">--</div>
                            </div>
                        </div>
                        
            <!-- ç¬¬äºŒè¡Œï¼šæˆç»©åˆ†å¸ƒå›¾è¡¨å’Œèƒ½åŠ›é›·è¾¾å›¾ -->
            <div class="main-content" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                <div class="content-card">
                    <div class="card-header">
                        <i class="fas fa-chart-pie"></i> æˆç»©åˆ†å¸ƒç»Ÿè®¡
                    </div>
                    <div class="chart-container">
                        <div id="score-distribution-chart" style="background: #f8f9fa; border-radius: 8px; display: flex; align-items: center; justify-content: center; color: #7f8c8d;">
                                é€‰æ‹©è€ƒè¯•åæ˜¾ç¤ºæˆç»©åˆ†å¸ƒå›¾è¡¨
                        </div>
                    </div>
                </div>
                
                <div class="content-card">
                    <div class="card-header">
                        <i class="fas fa-star"></i> èƒ½åŠ›ç»´åº¦é›·è¾¾å›¾
                        <div class="card-actions">
                            <select id="radar-student-select" class="form-select" style="margin-right: 10px;" onchange="updateStudentRadarChart()">
                                <option value="">é€‰æ‹©å­¦ç”Ÿ</option>
                                <option value="all">å…¨ç­å¹³å‡</option>
                            </select>
                        </div>
                    </div>
                    <div class="chart-container">
                        <div id="capability-radar-chart" style="background: #f8f9fa; border-radius: 8px; height: 400px; display: flex; align-items: center; justify-content: center; color: #7f8c8d; position: relative;">
                            <canvas id="radarCanvas" width="350" height="350" style="display: none;"></canvas>
                            <div id="radar-empty-state">é€‰æ‹©è€ƒè¯•å’Œå­¦ç”Ÿåæ˜¾ç¤ºèƒ½åŠ›é›·è¾¾å›¾</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- ç¬¬ä¸‰è¡Œï¼šé”™è¯¯ç‡åˆ†æ -->
            <div class="main-content">
                <div class="content-card">
                    <div class="card-header">
                        <i class="fas fa-exclamation-triangle"></i> é”™è¯¯ç‡åˆ†æ
                    </div>
                    <div class="table-container">
                        <table id="error-analysis-table">
                            <thead>
                                <tr>
                                    <th>é¢˜ç›®ç¼–å·</th>
                                    <th>é¢˜ç›®ç±»å‹</th>
                                    <th>çŸ¥è¯†ç‚¹</th>
                                    <th>é”™è¯¯ç‡</th>
                                    <th>å¸¸è§é”™è¯¯</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- åŠ¨æ€åŠ è½½å†…å®¹ -->
                            </tbody>
                        </table>
                    </div>
                </div>

        </section>
        
        <section id="improve-suggest" class="main-section hidden-section">
            <div class="content-header">
                <h1 class="page-title">æ•™å­¦æ”¹è¿›å»ºè®®</h1>
                <div class="header-actions">
                    <button class="btn btn-primary" onclick="generateImprovements()">
                        <i class="fas fa-magic"></i> AIç”Ÿæˆå»ºè®®
                    </button>
                    <button class="btn btn-accent" onclick="exportImprovements()">
                        <i class="fas fa-download"></i> å¯¼å‡ºæŠ¥å‘Š
                    </button>
                    <button id="my-reports-btn" class="btn btn-secondary" onclick="showMyReportsModal()" style="display: none;">
                        <i class="fas fa-history"></i> æˆ‘çš„æŠ¥å‘Š
                    </button>
                </div>
            </div>
            
            <div class="main-content">
                <div class="content-card">
                    <div class="card-header">
                        <i class="fas fa-lightbulb"></i> æ™ºèƒ½æ•™å­¦æ”¹è¿›å»ºè®®
                    </div>
                    <div style="padding: 24px;">
                        <!-- é€‰æ‹©è¯¾ç¨‹ä¸‹æ‹‰æ ç‹¬å ä¸€è¡Œ -->
                        <div style="margin-bottom: 24px; padding-bottom: 20px; border-bottom: 1px solid #e9ecef;">
                            <div class="form-group" style="margin-bottom: 0;">
                            <label>é€‰æ‹©è¯¾ç¨‹ï¼š</label>
                            <select id="improve-course-select" class="form-select">
                                <option value="">è¯·é€‰æ‹©è¯¾ç¨‹</option>
                            </select>
                            </div>
                        </div>
                        
                        <div id="improvements-content">
                            <!-- AIç”Ÿæˆçš„æ”¹è¿›å»ºè®®å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ -->
                            <div class="empty-state">
                                <i class="fas fa-lightbulb" style="font-size: 48px; color: #ddd; margin-bottom: 16px;"></i>
                                <p>ç‚¹å‡»"AIç”Ÿæˆå»ºè®®"è·å–ä¸ªæ€§åŒ–æ•™å­¦æ”¹è¿›å»ºè®®</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        


        
        <!-- äº’åŠ¨äº¤æµ - å¯¹è¯åˆ—è¡¨ -->
        <section id="message-conversations" class="main-section hidden-section">
            <div class="content-header">
                <h1 class="page-title">æˆ‘çš„å¯¹è¯</h1>
                <div class="header-actions">
                    <button class="btn btn-primary" onclick="refreshConversations()">
                        <i class="fas fa-sync-alt"></i> åˆ·æ–°å¯¹è¯
                    </button>
                    <span id="unread-count-badge" class="badge" style="background: #e74c3c; color: white; padding: 4px 8px; border-radius: 12px; margin-left: 10px; display: none;">0</span>
                </div>
            </div>
            
            <div class="main-content" style="display: flex; height: 600px;">
                <!-- å¯¹è¯åˆ—è¡¨ -->
                <div class="content-card" style="width: 30%; margin-right: 16px; overflow-y: auto;">
                    <div class="card-header">
                        <i class="fas fa-list"></i> å¯¹è¯åˆ—è¡¨
                    </div>
                    <div id="conversations-list" style="padding: 0;">
                        <!-- åŠ¨æ€åŠ è½½çš„å¯¹è¯åˆ—è¡¨ -->
                    </div>
                    <div id="conversations-empty" style="display: none; text-align: center; padding: 40px; color: #6c757d;">
                        <i class="fas fa-comments" style="font-size: 48px; margin-bottom: 16px; opacity: 0.5;"></i>
                        <p>æš‚æ— å¯¹è¯</p>
                        <p>ç‚¹å‡»"æ–°å»ºå¯¹è¯"å¼€å§‹èŠå¤©</p>
                    </div>
                </div>
                
                <!-- èŠå¤©çª—å£ -->
                <div class="content-card" style="width: 70%; display: flex; flex-direction: column;">
                    <div class="card-header" id="chat-header" style="display: none;">
                        <i class="fas fa-user"></i> 
                        <span id="chat-partner-name">è¯·é€‰æ‹©å¯¹è¯</span>
                        <div style="float: right;">
                            <button class="btn btn-sm btn-secondary" onclick="markCurrentChatAsRead()">
                                <i class="fas fa-check"></i> æ ‡è®°å·²è¯»
                            </button>
                        </div>
                    </div>
                    <div id="chat-messages" style="
                        flex: 1; 
                        padding: 12px 0; 
                        overflow-y: auto; 
                        background: #f5f5f5;
                        display: flex; 
                        align-items: center; 
                        justify-content: center; 
                        color: #6c757d;
                        scroll-behavior: smooth;
                    ">
                        <div style="text-align: center;">
                            <i class="fas fa-comments" style="font-size: 48px; margin-bottom: 16px; opacity: 0.5;"></i>
                            <p>é€‰æ‹©ä¸€ä¸ªå¯¹è¯å¼€å§‹èŠå¤©</p>
                        </div>
                    </div>
                    <div id="chat-input-area" style="
                        display: none; 
                        padding: 12px 16px; 
                        border-top: 1px solid #e9ecef; 
                        background: white;
                        box-shadow: 0 -2px 8px rgba(0,0,0,0.1);
                    ">
                        <div style="display: flex; gap: 8px; align-items: end;">
                            <input type="text" id="message-input" 
                                   style="
                                       flex: 1; 
                                       padding: 10px 16px; 
                                       border: 1px solid #ddd; 
                                       border-radius: 20px; 
                                       font-size: 14px; 
                                       outline: none; 
                                       resize: none;
                                       min-height: 20px;
                                       max-height: 100px;
                                   " 
                                   placeholder="è¾“å…¥æ¶ˆæ¯..." 
                                   onkeypress="handleMessageKeyPress(event)"
                                   onfocus="this.style.borderColor='#007bff'"
                                   onblur="this.style.borderColor='#ddd'">
                            <button onclick="sendMessage()" 
                                    style="
                                        width: 44px; 
                                        height: 44px; 
                                        border: none; 
                                        border-radius: 50%; 
                                        background: linear-gradient(135deg, #007bff 0%, #0056b3 100%); 
                                        color: white; 
                                        cursor: pointer; 
                                        display: flex; 
                                        align-items: center; 
                                        justify-content: center;
                                        transition: all 0.2s ease;
                                        box-shadow: 0 2px 8px rgba(0,123,255,0.3);
                                    "
                                    onmouseover="this.style.transform='scale(1.05)'"
                                    onmouseout="this.style.transform='scale(1)'"
                                    title="å‘é€æ¶ˆæ¯ (Enter)">
                                <i class="fas fa-paper-plane" style="font-size: 16px;"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- äº’åŠ¨äº¤æµ - æ–°å»ºå¯¹è¯ -->
        <section id="message-new-chat" class="main-section hidden-section">
            <div class="content-header">
                <h1 class="page-title">æ–°å»ºå¯¹è¯</h1>
                <div class="header-actions">
                    <button class="btn btn-primary" onclick="refreshAvailableUsers()">
                        <i class="fas fa-sync-alt"></i> åˆ·æ–°åˆ—è¡¨
                    </button>
                </div>
            </div>
            
            <div class="main-content">
                <!-- è¯¾ç¨‹é€‰æ‹© -->
                <div class="content-card">
                    <div class="card-header">
                        <i class="fas fa-book"></i> é€‰æ‹©è¯¾ç¨‹
                    </div>
                    <div style="padding: 16px;">
                        <div class="form-group">
                            <label>é€‰æ‹©è¯¾ç¨‹:</label>
                            <select id="course-select" class="form-control" onchange="loadTeacherCourseUsers(this.value)">
                                <option value="">è¯·é€‰æ‹©è¯¾ç¨‹</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <!-- ç”¨æˆ·åˆ—è¡¨ -->
                <div class="content-card">
                    <div class="card-header">
                        <i class="fas fa-users"></i> å¯èŠå¤©ç”¨æˆ·
                    </div>
                    <div id="available-users-list" style="padding: 16px;">
                        <!-- ç”¨æˆ·å¡ç‰‡å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                    
                    <!-- ç©ºçŠ¶æ€ -->
                    <div id="users-empty" style="display: block;">
                        <div style="text-align: center; padding: 48px 0; color: #7f8c8d;">
                            <i class="fas fa-users" style="font-size: 48px; margin-bottom: 16px; color: #bdc3c7;"></i>
                            <p>æš‚æ— å¯å¯¹è¯ç”¨æˆ·</p>
                            <p>è¯·å…ˆé€‰æ‹©è¯¾ç¨‹</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
                    </div>
                </div>
            </div>
        </section>
        
        <div class="content-footer">
            <p>Â© 2025 æ™ºæ•™SmartEdu - æ•™å­¦å®è®­æ™ºèƒ½ä½“è½¯ä»¶ | åŸºäºDeepSeekå¤§æ¨¡å‹</p>
        </div>
    </main>

    <!-- æˆç»©æ‰¹æ”¹æ¨¡æ€æ¡† -->
    <div id="grade-modal" class="course-modal-overlay">
        <div class="course-modal-container" style="width: 1200px; height: 800px; max-width: 95vw; max-height: 95vh; display: flex; flex-direction: column;">
            <div class="course-modal-header">
                <div class="modal-title-section">
                    <div class="modal-icon" style="background: rgba(230, 126, 34, 0.1);">
                        <i class="fas fa-edit" style="color: #e67e22;"></i>
                    </div>
                    <h3><i class="fas fa-marker"></i> æˆç»©æ‰¹æ”¹</h3>
                </div>
                <button id="close-grade-modal" class="modal-close-btn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="course-modal-body" style="flex: 1; display: flex; flex-direction: column; overflow: hidden; padding: 0;">
                <div class="grade-info-header" style="background: #f8f9fa; padding: 20px; border-bottom: 1px solid #e9ecef;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <h4 id="grade-student-name" style="margin: 0; color: #2c3e50;">å­¦ç”Ÿå§“å</h4>
                            <p id="grade-exam-info" style="margin: 5px 0 0 0; color: #7f8c8d; font-size: 14px;">è€ƒè¯•ä¿¡æ¯</p>
                        </div>
                        <div style="text-align: right;">
                            <div style="display: flex; gap: 30px; align-items: center;">
                                <div style="text-align: center;">
                                    <div style="font-size: 14px; color: #7f8c8d;">AIè¯„åˆ†</div>
                                    <div id="grade-ai-score" style="font-size: 24px; font-weight: bold; color: #3498db;">--</div>
                                </div>
                                <div style="text-align: center;">
                                    <div style="font-size: 14px; color: #7f8c8d;">äººå·¥è¯„åˆ†</div>
                                    <div id="grade-manual-score" style="font-size: 24px; font-weight: bold; color: #27ae60;">--</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="grade-content" style="flex: 1; display: flex; overflow: hidden;">
                    <!-- å·¦ä¾§ï¼šè¯•å·å†…å®¹ -->
                    <div class="grade-paper-panel" style="flex: 2; overflow-y: auto; padding: 20px; background: white; border-right: 1px solid #e9ecef;">
                        <div id="grade-questions-container">
                            <!-- åŠ¨æ€åŠ è½½è¯•å·å†…å®¹ -->
                        </div>
                    </div>
                    
                    <!-- å³ä¾§ï¼šè¯„åˆ†é¢æ¿ -->
                    <div class="grade-scoring-panel" style="flex: 1; display: flex; flex-direction: column; background: #f8f9fa;">
                        <div style="padding: 20px; border-bottom: 1px solid #e9ecef;">
                            <h5 style="margin: 0 0 15px 0; color: #2c3e50;">
                                <i class="fas fa-calculator"></i> è¯„åˆ†é¢æ¿
                            </h5>
                            
                            <div class="form-group">
                                <label class="course-form-label">æœ€ç»ˆå¾—åˆ†ï¼š</label>
                                <input type="number" id="grade-final-score" class="course-form-input" min="0" max="100" step="0.5" placeholder="è¯·è¾“å…¥æœ€ç»ˆå¾—åˆ†">
                            </div>
                            
                            <div class="form-group">
                                <label class="course-form-label">æ•™å¸ˆè¯„è¯­ï¼š</label>
                                <textarea id="grade-teacher-comments" class="course-form-input" rows="4" placeholder="è¯·è¾“å…¥æ•™å¸ˆè¯„è¯­ï¼ˆå¯é€‰ï¼‰..."></textarea>
                            </div>
                            

                        </div>
                        
                        <div style="flex: 1; padding: 20px;">
                            <h6 style="margin: 0 0 15px 0; color: #2c3e50;">
                                <i class="fas fa-info-circle"></i> è¯„åˆ†è¯´æ˜
                            </h6>
                            <ul style="margin: 0; padding-left: 20px; color: #7f8c8d; font-size: 14px; line-height: 1.6;">
                                <li>AIå·²æ ¹æ®æ ‡å‡†ç­”æ¡ˆè¿›è¡Œåˆæ­¥è¯„åˆ†</li>
                                <li>æ‚¨å¯ä»¥æ ¹æ®å­¦ç”Ÿç­”æ¡ˆçš„å®é™…æƒ…å†µè°ƒæ•´åˆ†æ•°</li>
                                <li>å»ºè®®ä¸ºå­¦ç”Ÿæä¾›è¯¦ç»†çš„è¯„è¯­å’Œæ”¹è¿›å»ºè®®</li>
                                <li>å¯å¯¹æ¯é“é¢˜è¿›è¡Œå•ç‹¬è¯„åˆ†å’Œè¯„è¯­</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="course-modal-footer" style="display: flex; gap: 12px; justify-content: center; padding: 15px 20px; border-top: 1px solid #e9ecef;">
                <button type="button" class="btn btn-secondary" onclick="hideGradeModal()">
                    <i class="fas fa-times"></i> å–æ¶ˆ
                </button>
                <button type="button" class="btn btn-success" onclick="saveGrade()">
                    <i class="fas fa-save"></i> ä¿å­˜è¯„åˆ†
                </button>
            </div>
        </div>
    </div>

    <!-- æˆç»©è¯¦æƒ…æŸ¥çœ‹æ¨¡æ€æ¡† -->
    <div id="grade-detail-modal" class="course-modal-overlay">
        <div class="course-modal-container" style="width: 1000px; height: 700px; max-width: 95vw; max-height: 95vh; display: flex; flex-direction: column;">
            <div class="course-modal-header">
                <div class="modal-title-section">
                    <div class="modal-icon" style="background: rgba(52, 152, 219, 0.1);">
                        <i class="fas fa-eye" style="color: #3498db;"></i>
                    </div>
                    <h3><i class="fas fa-file-alt"></i> æˆç»©è¯¦æƒ…</h3>
                </div>
                <button id="close-grade-detail-modal" class="modal-close-btn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="course-modal-body" style="flex: 1; overflow-y: auto; padding: 20px;">
                <div class="grade-detail-header" style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <h4 id="detail-student-name" style="margin: 0; color: #2c3e50;">å­¦ç”Ÿå§“å</h4>
                            <p id="detail-exam-info" style="margin: 5px 0 0 0; color: #7f8c8d; font-size: 14px;">è€ƒè¯•ä¿¡æ¯</p>
                        </div>
                        <div style="text-align: right;">
                            <div style="font-size: 14px; color: #7f8c8d;">æœ€ç»ˆå¾—åˆ†</div>
                            <div id="detail-final-score" style="font-size: 24px; font-weight: bold; color: #27ae60;">--</div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #e9ecef;">
                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; font-size: 14px;">
                            <div>
                                <span style="color: #7f8c8d;">AIè¯„åˆ†ï¼š</span>
                                <span id="detail-ai-score" style="font-weight: bold;">--</span>
                            </div>
                            <div>
                                <span style="color: #7f8c8d;">æäº¤æ—¶é—´ï¼š</span>
                                <span id="detail-submit-time" style="font-weight: bold;">--</span>
                            </div>
                            <div>
                                <span style="color: #7f8c8d;">æ‰¹æ”¹çŠ¶æ€ï¼š</span>
                                <span id="detail-grade-status" style="font-weight: bold;">--</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="detail-teacher-comments" style="display: none; background: #e8f5e8; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                    <h6 style="margin: 0 0 10px 0; color: #27ae60;">
                        <i class="fas fa-comment"></i> æ•™å¸ˆè¯„è¯­
                    </h6>
                    <p id="detail-comments-text" style="margin: 0; line-height: 1.6;"></p>
                </div>
                
                <div id="detail-questions-container">
                    <!-- åŠ¨æ€åŠ è½½è¯•å·è¯¦æƒ… -->
                </div>
            </div>
            
            <div class="course-modal-footer" style="display: flex; gap: 12px; justify-content: center; padding: 15px 20px; border-top: 1px solid #e9ecef;">
                <button type="button" class="btn btn-secondary" onclick="hideGradeDetailModal()">
                    <i class="fas fa-arrow-left"></i> è¿”å›
                </button>
                <button type="button" class="btn btn-primary" onclick="editGradeFromDetail()">
                    <i class="fas fa-edit"></i> é‡æ–°æ‰¹æ”¹
                </button>
            </div>
        </div>
    </div>

    <!-- çŸ¥è¯†åº“æ–‡æ¡£ä¸Šä¼ æ¨¡æ€æ¡† -->
    <div id="knowledge-upload-modal" class="course-modal-overlay">
        <div class="course-modal-container" style="max-width: 900px;">
            <div class="course-modal-header">
                <div class="modal-title-section">
                    <div class="modal-icon">
                        <i class="fas fa-database"></i>
                    </div>
                    <h3>æ„å»ºè¯¾ç¨‹çŸ¥è¯†åº“</h3>
                </div>
                <button id="close-knowledge-upload-modal" class="modal-close-btn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="course-modal-body">
                <div class="upload-tabs" style="margin-bottom: 24px;">
                    <button class="tab-btn active" data-tab="single-upload">
                        <i class="fas fa-file"></i> å•æ–‡æ¡£ä¸Šä¼ 
                    </button>
                    <button class="tab-btn" data-tab="batch-upload">
                        <i class="fas fa-files"></i> æ‰¹é‡ä¸Šä¼ 
                    </button>
                </div>

                <!-- å•æ–‡æ¡£ä¸Šä¼  -->
                <div id="single-upload" class="tab-content active">
                    <form id="knowledge-single-upload-form">
                        <div class="course-form-group" style="margin-bottom: 20px;">
                            <label class="course-form-label">
                                <i class="fas fa-book"></i>
                                é€‰æ‹©è¯¾ç¨‹ <span class="required">*</span>
                            </label>
                            <select id="knowledge-course-select" class="course-form-input" required>
                                <option value="">è¯·é€‰æ‹©è¯¾ç¨‹</option>
                            </select>
                        </div>
                        
                        <div class="course-form-group">
                            <label class="course-form-label">
                                <i class="fas fa-file-alt"></i>
                                é€‰æ‹©æ–‡æ¡£ <span class="required">*</span>
                            </label>
                            <div class="file-upload-area" id="knowledge-file-upload-area">
                                <input type="file" id="knowledge-file-input" accept=".txt,.pdf,.doc,.docx,.html,.htm" style="display: none;" required>
                                <div class="upload-prompt">
                                    <i class="fas fa-cloud-upload-alt"></i>
                                    <p>ç‚¹å‡»ä¸Šä¼ æ–‡æ¡£æˆ–æ‹–æ‹½æ–‡æ¡£è‡³æ­¤åŒºåŸŸ</p>
                                    <p class="upload-tips">æ”¯æŒ TXTã€PDFã€DOCã€DOCXã€HTML æ ¼å¼ï¼Œå•ä¸ªæ–‡ä»¶ä¸è¶…è¿‡50MB</p>
                                </div>
                            </div>
                            <div id="single-file-preview" style="display: none; margin-top: 12px; padding: 12px; background: #f8f9fa; border-radius: 6px; border: 1px solid #e9ecef;">
                                <div style="display: flex; align-items: center; gap: 12px;">
                                    <i class="fas fa-file-alt" style="color: #007bff;"></i>
                                    <span id="single-file-name"></span>
                                    <span id="single-file-size" style="color: #6c757d; font-size: 12px;"></span>
                                    <button type="button" onclick="removeSingleFile()" style="margin-left: auto; background: none; border: none; color: #dc3545; cursor: pointer;">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                        </div>
                    </div>
                    
                        <div class="course-form-group">
                            <label class="course-form-label">
                                <i class="fas fa-edit"></i>
                                æ–‡æ¡£æè¿°
                            </label>
                            <textarea id="knowledge-description" class="course-form-input" rows="3" placeholder="è¯·è¾“å…¥æ–‡æ¡£çš„ç®€è¦æè¿°ï¼ˆå¯é€‰ï¼‰..."></textarea>
                                </div>
                        
                        <div class="course-modal-actions">
                            <button type="button" id="cancel-knowledge-upload" class="course-btn course-btn-cancel">
                                <i class="fas fa-times"></i>
                                <span>å–æ¶ˆ</span>
                            </button>
                            <button type="submit" class="course-btn course-btn-primary">
                                <i class="fas fa-robot"></i>
                                <span>ä¸Šä¼ å¹¶æ™ºèƒ½å¤„ç†</span>
                            </button>
                            </div>
                    </form>
                        </div>
                        
                <!-- æ‰¹é‡ä¸Šä¼  -->
                <div id="batch-upload" class="tab-content">
                    <form id="knowledge-batch-upload-form">
                        <div class="course-form-group" style="margin-bottom: 20px;">
                            <label class="course-form-label">
                                <i class="fas fa-book"></i>
                                é€‰æ‹©è¯¾ç¨‹ <span class="required">*</span>
                            </label>
                            <select id="batch-course-select" class="course-form-input" required>
                                <option value="">è¯·é€‰æ‹©è¯¾ç¨‹</option>
                            </select>
                        </div>
                        
                        <div class="course-form-group">
                            <label class="course-form-label">
                                <i class="fas fa-files"></i>
                                é€‰æ‹©å¤šä¸ªæ–‡æ¡£ <span class="required">*</span>
                            </label>
                            <div class="file-upload-area" id="batch-file-upload-area">
                                <input type="file" id="batch-file-input" accept=".txt,.pdf,.doc,.docx,.html,.htm" multiple style="display: none;" required>
                                <div class="upload-prompt">
                                    <i class="fas fa-cloud-upload-alt"></i>
                                    <p>ç‚¹å‡»é€‰æ‹©å¤šä¸ªæ–‡æ¡£æˆ–æ‹–æ‹½æ–‡æ¡£è‡³æ­¤åŒºåŸŸ</p>
                                    <p class="upload-tips">æ”¯æŒ TXTã€PDFã€DOCã€DOCXã€HTML æ ¼å¼ï¼Œå¯åŒæ—¶é€‰æ‹©å¤šä¸ªæ–‡ä»¶</p>
                                </div>
                            </div>
                            <div id="batch-files-preview" style="display: none; max-height: 200px; overflow-y: auto; margin-top: 12px; padding: 12px; background: #f8f9fa; border-radius: 6px; border: 1px solid #e9ecef;">
                                <div style="margin-bottom: 8px; font-weight: 500; color: #495057;">
                                    å·²é€‰æ‹© <span id="batch-file-count">0</span> ä¸ªæ–‡ä»¶
                                </div>
                                <div id="batch-file-list"></div>
                        </div>
                    </div>
                    
                    <div class="course-modal-actions">
                            <button type="button" id="cancel-batch-upload" class="course-btn course-btn-cancel">
                            <i class="fas fa-times"></i>
                            <span>å–æ¶ˆ</span>
                        </button>
                        <button type="submit" class="course-btn course-btn-primary">
                                <i class="fas fa-robot"></i>
                                <span>æ‰¹é‡ä¸Šä¼ å¹¶å¤„ç†</span>
                        </button>
                    </div>
                </form>
            </div>

                <!-- å¤„ç†è¿›åº¦ -->
                <div id="knowledge-processing" style="display: none; padding: 24px; text-align: center;">
                    <div style="margin-bottom: 16px;">
                        <i class="fas fa-robot fa-3x" style="color: #007bff; animation: pulse 2s infinite;"></i>
                    </div>
                    <h4>AIæ™ºèƒ½å¤„ç†ä¸­...</h4>
                    <p id="processing-status" style="color: #6c757d; margin-bottom: 20px;">æ­£åœ¨åˆ†ææ–‡æ¡£å†…å®¹</p>
                    <div class="progress-bar" style="width: 100%; height: 8px; background: #e9ecef; border-radius: 4px; overflow: hidden;">
                        <div id="processing-progress" class="progress-fill" style="width: 0%; height: 100%; background: linear-gradient(45deg, #007bff, #0056b3); transition: width 0.3s ease-in-out;"></div>
                    </div>
                    <div id="processing-details" style="margin-top: 16px; font-size: 14px; color: #6c757d;">
                        <div id="processing-step">æ­¥éª¤ 1/4: æ–‡æ¡£ä¸Šä¼ </div>
                        <div id="processing-info" style="margin-top: 8px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>



    <!-- ä¿®æ”¹å¯†ç æ¨¡æ€æ¡† -->
    <div id="change-password-modal" class="course-modal-overlay">
        <div class="course-modal-container" style="max-width: 450px;">
            <div class="course-modal-header">
                <div class="modal-title-section">
                    <div class="modal-icon">
                        <i class="fas fa-key"></i>
                    </div>
                    <h3>ä¿®æ”¹å¯†ç </h3>
                </div>
                <button id="close-password-modal" class="modal-close-btn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="course-modal-body">
                <form id="change-password-form">
                    <div class="course-form-group">
                        <label class="course-form-label">
                            <i class="fas fa-lock"></i>
                            å½“å‰å¯†ç  <span class="required">*</span>
                        </label>
                        <input type="password" id="current-password" class="course-form-input" placeholder="è¯·è¾“å…¥å½“å‰å¯†ç " required>
                    </div>
                    
                    <div class="course-form-group">
                        <label class="course-form-label">
                            <i class="fas fa-lock"></i>
                            æ–°å¯†ç  <span class="required">*</span>
                        </label>
                        <input type="password" id="new-password" class="course-form-input" placeholder="è¯·è¾“å…¥æ–°å¯†ç ï¼ˆè‡³å°‘6ä½ï¼‰" required minlength="6">
                    </div>
                    
                    <div class="course-form-group">
                        <label class="course-form-label">
                            <i class="fas fa-lock"></i>
                            ç¡®è®¤æ–°å¯†ç  <span class="required">*</span>
                        </label>
                        <input type="password" id="confirm-password" class="course-form-input" placeholder="è¯·å†æ¬¡è¾“å…¥æ–°å¯†ç " required minlength="6">
                    </div>
                    
                    <div class="course-modal-actions">
                        <button type="button" id="cancel-password-change" class="course-btn course-btn-cancel">
                            <i class="fas fa-times"></i>
                            <span>å–æ¶ˆ</span>
                        </button>
                        <button type="submit" class="course-btn course-btn-primary">
                            <i class="fas fa-save"></i>
                            <span>ç¡®è®¤ä¿®æ”¹</span>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- æ³¨é”€è´¦æˆ·æ¨¡æ€æ¡† -->
    <div id="delete-account-modal" class="course-modal-overlay">
        <div class="course-modal-container" style="max-width: 500px;">
            <div class="course-modal-header">
                <div class="modal-title-section">
                    <div class="modal-icon" style="background-color: rgba(231, 76, 60, 0.1);">
                        <i class="fas fa-user-times" style="color: #e74c3c;"></i>
                    </div>
                    <h3 style="color: #e74c3c;">æ³¨é”€è´¦æˆ·</h3>
                </div>
                <button id="close-delete-account-modal" class="modal-close-btn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="course-modal-body">
                <div class="alert-danger" style="background: #f8d7da; border: 1px solid #f5c6cb; border-radius: 8px; padding: 16px; margin-bottom: 24px;">
                    <div style="display: flex; align-items: flex-start; gap: 12px;">
                        <i class="fas fa-exclamation-triangle" style="color: #721c24; font-size: 20px; margin-top: 2px;"></i>
                        <div style="color: #721c24;">
                            <h4 style="margin: 0 0 8px 0; font-size: 16px;">å±é™©æ“ä½œè­¦å‘Š</h4>
                            <p style="margin: 0; font-size: 14px; line-height: 1.4;">
                                æ³¨é”€è´¦æˆ·å°†æ°¸ä¹…åˆ é™¤ä»¥ä¸‹æ‰€æœ‰æ•°æ®ï¼Œä¸”<strong>æ— æ³•æ¢å¤</strong>ï¼š
                            </p>
                            <ul style="margin: 8px 0 0 16px; font-size: 14px;">
                                <li>ä¸ªäººèµ„æ–™å’Œè´¦æˆ·ä¿¡æ¯</li>
                                <li>æ‰€æœ‰è¯¾ç¨‹åŠè¯¾ç¨‹èµ„æ–™</li>
                                <li>æ•™å­¦å¤§çº²å’Œé€šçŸ¥</li>
                                <li>è€ƒè¯•å’Œæˆç»©æ•°æ®</li>
                                <li>å…¶ä»–ç›¸å…³æ•™å­¦æ•°æ®</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <form id="delete-account-form">
                    <div class="course-form-group">
                        <label class="course-form-label">
                            <i class="fas fa-lock"></i>
                            è¯·è¾“å…¥æ‚¨çš„å¯†ç ä»¥ç¡®è®¤æ³¨é”€ <span class="required">*</span>
                        </label>
                        <input type="password" id="delete-account-password" class="course-form-input" placeholder="è¯·è¾“å…¥æ‚¨çš„ç™»å½•å¯†ç " required>
                    </div>
                    
                    <div class="course-form-group" style="margin-top: 20px;">
                        <label class="checkbox-container" style="margin-top: 8px;">
                            <input type="checkbox" id="delete-account-confirm" required>
                            <span class="checkmark"></span>
                            <span>æˆ‘å·²çŸ¥æ™“æ­¤æ“ä½œçš„é£é™©ï¼Œç¡®è®¤è¦æ°¸ä¹…æ³¨é”€è´¦æˆ·</span>
                        </label>
                    </div>
                    
                    <div class="course-modal-actions">
                        <button type="button" id="cancel-delete-account" class="course-btn course-btn-cancel">
                            <i class="fas fa-times"></i>
                            <span>å–æ¶ˆ</span>
                        </button>
                        <button type="submit" class="course-btn" style="background: #e74c3c; border-color: #e74c3c;">
                            <i class="fas fa-user-times"></i>
                            <span>ç¡®è®¤æ³¨é”€è´¦æˆ·</span>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- é€€å‡ºç¡®è®¤å¼¹çª— -->
    <div id="logout-modal" style="display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.2);align-items:center;justify-content:center;z-index:999;">
        <div style="background:#fff;padding:32px 24px;border-radius:12px;box-shadow:0 4px 24px rgba(44,62,80,0.10);min-width:320px;display:flex;flex-direction:column;gap:20px;align-items:center;">
            <div style="font-size:18px;color:var(--secondary-color);font-weight:500;">ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ</div>
            <div style="display:flex;gap:16px;">
                <button id="confirm-logout" class="btn btn-primary">ç¡®å®š</button>
                <button id="cancel-logout" class="btn btn-accent">å–æ¶ˆ</button>
            </div>
        </div>
    </div>

    <!-- æ–°å»ºè¯¾ç¨‹æ¨¡æ€æ¡† -->
    <div id="create-course-modal" class="course-modal-overlay">
        <div class="course-modal-container">
            <div class="course-modal-header">
                <div class="modal-title-section">
                    <div class="modal-icon">
                        <i class="fas fa-plus-circle"></i>
                    </div>
                    <h3>æ–°å»ºè¯¾ç¨‹</h3>
                </div>
                <button id="close-course-modal" class="modal-close-btn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="course-modal-body">
                <form id="create-course-form">
                    <div class="course-form-grid">
                        <div class="course-form-group">
                            <label class="course-form-label">
                                <i class="fas fa-book"></i>
                                è¯¾ç¨‹åç§° <span class="required">*</span>
                            </label>
                            <input type="text" id="course-name" class="course-form-input" placeholder="è¯·è¾“å…¥è¯¾ç¨‹åç§°" required>
                        </div>
                        
                        <div class="course-form-group">
                            <label class="course-form-label">
                                <i class="fas fa-calendar-alt"></i>
                                å¼€è¯¾å­¦æœŸ <span class="required">*</span>
                            </label>
                            <select id="course-semester" class="course-form-input" required>
                                <option value="">è¯·é€‰æ‹©å­¦æœŸ</option>
                                <option value="2024æ˜¥">2024æ˜¥</option>
                                <option value="2024ç§‹">2024ç§‹</option>
                                <option value="2025æ˜¥" selected>2025æ˜¥</option>
                                <option value="2025ç§‹">2025ç§‹</option>
                                <option value="2026æ˜¥">2026æ˜¥</option>
                                <option value="2026ç§‹">2026ç§‹</option>
                            </select>
                        </div>
                        
                        <div class="course-form-group" id="course-code-display" style="display: none;">
                            <label class="course-form-label">
                                <i class="fas fa-hashtag"></i>
                                è¯¾ç¨‹å·
                            </label>
                            <div class="course-code-readonly" id="course-code-readonly">
                                <span id="course-code-value">-</span>
                                <small class="form-help">è¯¾ç¨‹å·åˆ›å»ºåä¸å¯ä¿®æ”¹</small>
                            </div>
                        </div>
                        
                        <div class="course-form-group full-width">
                            <label class="course-form-label">
                                <i class="fas fa-align-left"></i>
                                è¯¾ç¨‹æè¿°
                            </label>
                            <textarea id="course-description" class="course-form-textarea" rows="3" placeholder="è¯·ç®€è¦æè¿°è¯¾ç¨‹å†…å®¹ä¸ç›®æ ‡"></textarea>
                        </div>
                        
                        <div class="course-form-group full-width">
                            <label class="course-form-label">
                                <i class="fas fa-target"></i>
                                åŸ¹å…»ç›®æ ‡
                            </label>
                            <div class="training-objectives-container">
                                <div id="training-objectives-list">
                                    <!-- åŸ¹å…»ç›®æ ‡é¡¹ç›®å°†åœ¨è¿™é‡ŒåŠ¨æ€æ·»åŠ  -->
                                </div>
                                <button type="button" class="add-objective-btn" onclick="addTrainingObjective()">
                                    <i class="fas fa-plus"></i>
                                    æ·»åŠ åŸ¹å…»ç›®æ ‡
                                </button>
                            </div>
                        </div>
                        
                        <div class="course-form-group">
                            <label class="course-form-label">
                                <i class="fas fa-star"></i>
                                å­¦åˆ† <span class="required">*</span>
                            </label>
                            <input type="number" id="course-credit" class="course-form-input" placeholder="1-10" min="1" max="10" required>
                        </div>
                        
                        <div class="course-form-group">
                            <label class="course-form-label">
                                <i class="fas fa-clock"></i>
                                å­¦æ—¶ <span class="required">*</span>
                            </label>
                            <input type="number" id="course-hours" class="course-form-input" placeholder="16-200" min="16" max="200" required>
                        </div>
                    </div>
                    
                    <div class="course-modal-actions">
                        <button type="button" id="cancel-course-create" class="course-btn course-btn-cancel">
                            <i class="fas fa-times"></i>
                            <span>å–æ¶ˆ</span>
                        </button>
                        <button type="submit" class="course-btn course-btn-primary">
                            <i class="fas fa-save"></i>
                            <span>åˆ›å»ºè¯¾ç¨‹</span>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- ä¸´æ—¶è§£å†³æ–¹æ¡ˆï¼šç›´æ¥åœ¨HTMLä¸­å®šä¹‰å‡½æ•° -->
    <script>
        function showUploadModal() {
            console.log('showUploadModal è¢«è°ƒç”¨ - HTMLç‰ˆæœ¬');
            const modal = document.getElementById('upload-material-modal');
            console.log('Modal element:', modal);
            
            if (!modal) {
                console.error('æ‰¾ä¸åˆ°ä¸Šä¼ æ¨¡æ€æ¡†å…ƒç´ ï¼');
                                 showNotification('æ‰¾ä¸åˆ°ä¸Šä¼ æ¨¡æ€æ¡†å…ƒç´ ï¼', 'error');
                return;
            }
            
            modal.classList.add('show');
            modal.style.display = 'flex';
            console.log('Modal å·²æ˜¾ç¤º');
            
            // ç®€å•çš„æ¸…ç©ºè¡¨å•
            const courseSelect = document.getElementById('modal-material-course-select');
            const typeSelect = document.getElementById('modal-material-type');
            const descriptionTextarea = document.getElementById('modal-material-description');
            const fileInput = document.getElementById('modal-file-input');
            const uploadArea = document.getElementById('modal-file-upload-area');
            
            if (courseSelect) courseSelect.value = '';
            if (typeSelect) typeSelect.value = 'PPT';
            if (descriptionTextarea) descriptionTextarea.value = '';
            if (fileInput) fileInput.value = '';
            
            // é‡ç½®æ–‡ä»¶ä¸Šä¼ åŒºåŸŸæ˜¾ç¤º
            if (uploadArea) {
                const prompt = uploadArea.querySelector('.upload-prompt');
                if (prompt) {
                    prompt.innerHTML = `
                        <i class="fas fa-cloud-upload-alt"></i>
                        <p>ç‚¹å‡»ä¸Šä¼ æ–‡ä»¶æˆ–æ‹–æ‹½æ–‡ä»¶è‡³æ­¤åŒºåŸŸ</p>
                        <p class="upload-tips">æ”¯æŒ PDFã€Wordã€PPTã€TXT æ ¼å¼ï¼Œå•ä¸ªæ–‡ä»¶ä¸è¶…è¿‡50MB</p>
                    `;
                }
            }
            
            // æ›´æ–°è¯¾ç¨‹é€‰æ‹©å™¨
            updateModalCourseSelect();
        }
        
        function hideUploadModal() {
            const modal = document.getElementById('upload-material-modal');
            modal.classList.remove('show');
            setTimeout(() => {
                modal.style.display = 'none';
            }, 300);
        }
        
        async function updateModalCourseSelect() {
            try {
                const response = await fetch('/api/teacher/courses');
                const apiResponse = await response.json();
                
                if (apiResponse.success && apiResponse.data) {
                    const select = document.getElementById('modal-material-course-select');
                    select.innerHTML = '<option value="">è¯·é€‰æ‹©è¯¾ç¨‹</option>';
                    
                    apiResponse.data.forEach(course => {
                        const option = document.createElement('option');
                        option.value = course.id;
                        option.textContent = `${course.name}ï¼ˆ${course.courseCode || 'SE-0000'}ï¼‰`;
                        select.appendChild(option);
                    });
                }
            } catch (error) {
                console.error('æ›´æ–°è¯¾ç¨‹é€‰æ‹©å™¨å¤±è´¥:', error);
            }
        }
        
        // è®¾ç½®å…³é—­æŒ‰é’®äº‹ä»¶å’Œæ–‡ä»¶ä¸Šä¼ äº‹ä»¶
        // é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨åŠ è½½èµ„æ–™åˆ—è¡¨ï¼ˆä¸æ˜¾ç¤ºæˆåŠŸé€šçŸ¥ï¼‰
        document.addEventListener('DOMContentLoaded', function() {
            // åˆå§‹åŒ–æ•™å¸ˆé¡µé¢ï¼Œä¼šåœ¨teacher.jsä¸­å¤„ç†æ‰€æœ‰äº‹ä»¶è®¾ç½®
            // è¿™é‡Œä»…ä¿ç•™å¿…è¦çš„åˆå§‹åŒ–é€»è¾‘
        });
         
         // åŠ è½½èµ„æ–™åˆ—è¡¨å‡½æ•°
         async function loadMaterials(showSuccessNotification = true) {
             try {
                 // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
                 const tableBody = document.querySelector('#materials-table tbody');
                 if (tableBody) {
                     tableBody.innerHTML = '<tr><td colspan="5" style="text-align: center; padding: 20px;"><i class="fas fa-spinner fa-spin"></i> åŠ è½½ä¸­...</td></tr>';
                 }
                 
                 // è°ƒç”¨APIè·å–èµ„æ–™åˆ—è¡¨
                 const response = await fetch('/api/teacher/materials');
                 const result = await response.json();
                 
                 if (result.success && result.data) {
                     displayMaterials(result.data);
                     if (showSuccessNotification) {
                         showNotification('èµ„æ–™åˆ—è¡¨åˆ·æ–°æˆåŠŸ', 'success');
                     }
                 } else {
                     tableBody.innerHTML = '<tr><td colspan="5" style="text-align: center; padding: 20px; color: #7f8c8d;">æš‚æ— èµ„æ–™æ•°æ®</td></tr>';
                     showNotification('åˆ·æ–°å¤±è´¥ï¼š' + (result.message || 'æœªçŸ¥é”™è¯¯'), 'error');
                 }
             } catch (error) {
                 console.error('åŠ è½½èµ„æ–™å¤±è´¥:', error);
                 const tableBody = document.querySelector('#materials-table tbody');
                 if (tableBody) {
                     tableBody.innerHTML = '<tr><td colspan="5" style="text-align: center; padding: 20px; color: #e74c3c;">åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥</td></tr>';
                 }
                 showNotification('åŠ è½½å¤±è´¥ï¼šç½‘ç»œé”™è¯¯', 'error');
             }
         }
         
         // æ˜¾ç¤ºèµ„æ–™åˆ—è¡¨å‡½æ•°
         function displayMaterials(materials) {
             const tableBody = document.querySelector('#materials-table tbody');
             if (!tableBody) return;
             
             if (!materials || materials.length === 0) {
                 tableBody.innerHTML = '<tr><td colspan="5" style="text-align: center; padding: 20px; color: #7f8c8d;">æš‚æ— èµ„æ–™</td></tr>';
                 return;
             }
             
             // æŒ‰è¯¾ç¨‹åˆ†ç»„
             const groupedMaterials = groupMaterialsByCourse(materials);
             
             // ç”Ÿæˆè¯¾ç¨‹é¢œè‰²æ˜ å°„
             const courseColors = generateCourseColors(Object.keys(groupedMaterials));
             
             let html = '';
             
             // éå†æ¯ä¸ªè¯¾ç¨‹ç»„
             Object.entries(groupedMaterials).forEach(([courseKey, courseMaterials]) => {
                 const color = courseColors[courseKey];
                 const courseInfo = courseMaterials[0].course;
                 const courseName = courseInfo ? courseInfo.name : 'æœªçŸ¥è¯¾ç¨‹';
                 const courseCode = courseInfo ? courseInfo.courseCode : '';
                 
                 // ä¸ºæ¯ä¸ªè¯¾ç¨‹çš„èµ„æ–™æ·»åŠ ç›¸åŒçš„èƒŒæ™¯è‰²
                 courseMaterials.forEach((material, index) => {
                     const fileSize = formatFileSize(material.fileSize);
                     const uploadTime = formatDateTime(material.uploadedAt);
                     
                     html += `
                         <tr style="background-color: ${color}20; border-left: 4px solid ${color};">
                             <td style="position: relative;">
                                 ${index === 0 ? `
                                     <div style="
                                         background: ${color}; 
                                         color: white; 
                                         padding: 4px 12px; 
                                         border-radius: 20px; 
                                         font-size: 13px; 
                                         font-weight: 500;
                                         display: inline-block;
                                         margin-bottom: 4px;
                                     ">
                                         ${courseName}${courseCode ? ` (${courseCode})` : ''}
                                     </div>
                                                                   ` : ''}
                              </td>
                             <td>
                                 <div style="display: flex; align-items: center; gap: 8px;">
                                     <i class="fas ${getFileIcon(material.materialType)}" style="color: ${color};"></i>
                                     <span>${material.originalName || material.filename}</span>
                                 </div>
                             </td>
                             <td>${uploadTime}</td>
                             <td>${fileSize}</td>
                             <td>
                                 <button class="btn btn-sm btn-primary" onclick="downloadMaterial(${material.id})" title="ä¸‹è½½">
                                     <i class="fas fa-download"></i>
                                 </button>
                                 <button class="btn btn-sm btn-danger" onclick="deleteMaterial(${material.id})" title="åˆ é™¤">
                                     <i class="fas fa-trash"></i>
                                 </button>
                             </td>
                         </tr>
                     `;
                 });
             });
             
             tableBody.innerHTML = html;
         }
         
         // æŒ‰è¯¾ç¨‹åˆ†ç»„èµ„æ–™
         function groupMaterialsByCourse(materials) {
             const grouped = {};
             
             materials.forEach(material => {
                 const courseId = material.course ? material.course.id : 'unknown';
                 const courseName = material.course ? material.course.name : 'æœªçŸ¥è¯¾ç¨‹';
                 const key = `${courseId}_${courseName}`;
                 
                 if (!grouped[key]) {
                     grouped[key] = [];
                 }
                 grouped[key].push(material);
             });
             
             // å¯¹æ¯ä¸ªè¯¾ç¨‹å†…çš„èµ„æ–™æŒ‰ä¸Šä¼ æ—¶é—´æ’åº
             Object.keys(grouped).forEach(key => {
                 grouped[key].sort((a, b) => new Date(b.uploadedAt) - new Date(a.uploadedAt));
             });
             
             return grouped;
         }
         
         // ç”Ÿæˆè¯¾ç¨‹é¢œè‰²æ˜ å°„
         function generateCourseColors(courseKeys) {
             const colors = [
                 '#3498db', '#e74c3c', '#2ecc71', '#f39c12', 
                 '#9b59b6', '#1abc9c', '#34495e', '#e67e22',
                 '#ad4e00', '#7f8c8d', '#27ae60', '#8e44ad',
                 '#16a085', '#2980b9', '#d35400', '#c0392b'
             ];
             
             const colorMap = {};
             courseKeys.forEach((key, index) => {
                 colorMap[key] = colors[index % colors.length];
             });
             
             return colorMap;
         }
         
         // æ ¼å¼åŒ–æ–‡ä»¶å¤§å°
         function formatFileSize(bytes) {
             if (!bytes) return '0 B';
             const sizes = ['B', 'KB', 'MB', 'GB'];
             const i = Math.floor(Math.log(bytes) / Math.log(1024));
             return Math.round(bytes / Math.pow(1024, i) * 100) / 100 + ' ' + sizes[i];
         }
         
         // æ ¼å¼åŒ–æ—¥æœŸæ—¶é—´
         function formatDateTime(dateString) {
             if (!dateString) return 'æœªçŸ¥æ—¶é—´';
             const date = new Date(dateString);
             return date.toLocaleString('zh-CN', {
                 year: 'numeric',
                 month: '2-digit',
                 day: '2-digit',
                 hour: '2-digit',
                 minute: '2-digit'
             });
         }
         
         // è·å–æ–‡ä»¶ç±»å‹æ ‡ç­¾
         function getFileTypeTag(materialType) {
             const typeMap = {
                 'PPT': '<span style="background: #e67e22; color: white; padding: 2px 8px; border-radius: 4px; font-size: 12px;">PPT</span>',
                 'PDF': '<span style="background: #e74c3c; color: white; padding: 2px 8px; border-radius: 4px; font-size: 12px;">PDF</span>',
                 'WORD': '<span style="background: #3498db; color: white; padding: 2px 8px; border-radius: 4px; font-size: 12px;">WORD</span>',
                 'OTHER': '<span style="background: #95a5a6; color: white; padding: 2px 8px; border-radius: 4px; font-size: 12px;">å…¶ä»–</span>'
             };
             return typeMap[materialType] || typeMap['OTHER'];
         }
         
         // è·å–æ–‡ä»¶å›¾æ ‡
         function getFileIcon(materialType) {
             const iconMap = {
                 'PPT': 'fa-file-powerpoint',
                 'PDF': 'fa-file-pdf',
                 'WORD': 'fa-file-word',
                 'OTHER': 'fa-file'
             };
             return iconMap[materialType] || iconMap['OTHER'];
         }
         
         // ä¸‹è½½èµ„æ–™
         function downloadMaterial(materialId) {
             window.open(`/api/teacher/materials/${materialId}/download`, '_blank');
         }
         
         // åˆ é™¤èµ„æ–™
         async function deleteMaterial(materialId) {
             // ä½¿ç”¨ç¾è§‚çš„ç¡®è®¤å¯¹è¯æ¡†æ›¿ä»£confirm
             if (!await showConfirmDialog('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªèµ„æ–™å—ï¼Ÿ', 'æ­¤æ“ä½œä¸å¯æ¢å¤')) {
                 return;
             }
             
             try {
                 const response = await fetch(`/api/teacher/materials/${materialId}`, {
                     method: 'DELETE'
                 });
                 
                 const result = await response.json();
                 
                 if (result.success) {
                     showNotification('èµ„æ–™åˆ é™¤æˆåŠŸ', 'success');
                     loadMaterialsData(); // åˆ é™¤åç›´æ¥è°ƒç”¨åˆ·æ–°èµ„æ–™
                 } else {
                     showNotification('åˆ é™¤å¤±è´¥ï¼š' + (result.message || 'æœªçŸ¥é”™è¯¯'), 'error');
                 }
             } catch (error) {
                 console.error('åˆ é™¤èµ„æ–™å¤±è´¥:', error);
                 showNotification('åˆ é™¤å¤±è´¥ï¼šç½‘ç»œé”™è¯¯', 'error');
             }
         }

          // ç¾è§‚çš„ç¡®è®¤å¯¹è¯æ¡†å‡½æ•°
         function showConfirmDialog(title, message) {
             return new Promise((resolve) => {
                 // åˆ›å»ºæ¨¡æ€æ¡†
                 const modal = document.createElement('div');
                 modal.style.cssText = `
                     position: fixed;
                     top: 0;
                     left: 0;
                     width: 100%;
                     height: 100%;
                     background: rgba(0, 0, 0, 0.5);
                     display: flex;
                     align-items: center;
                     justify-content: center;
                     z-index: 10001;
                     animation: fadeIn 0.3s ease;
                 `;
                 
                 const dialog = document.createElement('div');
                 dialog.style.cssText = `
                     background: white;
                     border-radius: 12px;
                     padding: 24px;
                     max-width: 400px;
                     width: 90%;
                     box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
                     animation: slideIn 0.3s ease;
                 `;
                 
                 dialog.innerHTML = `
                     <div style="display: flex; align-items: center; margin-bottom: 16px;">
                         <i class="fas fa-exclamation-triangle" style="color: #f39c12; font-size: 24px; margin-right: 12px;"></i>
                         <h3 style="margin: 0; color: #2c3e50; font-size: 18px;">${title}</h3>
                     </div>
                     <p style="margin: 0 0 24px 0; color: #5a6c7d; line-height: 1.5;">${message}</p>
                     <div style="display: flex; gap: 12px; justify-content: flex-end;">
                         <button id="confirm-cancel" style="
                             padding: 10px 20px;
                             border: 1px solid #ddd;
                             border-radius: 6px;
                             background: #f8f9fa;
                             color: #6c757d;
                             cursor: pointer;
                             font-size: 14px;
                             transition: all 0.2s ease;
                         ">å–æ¶ˆ</button>
                         <button id="confirm-ok" style="
                             padding: 10px 20px;
                             border: none;
                             border-radius: 6px;
                             background: #e74c3c;
                             color: white;
                             cursor: pointer;
                             font-size: 14px;
                             transition: all 0.2s ease;
                         ">ç¡®å®šåˆ é™¤</button>
                     </div>
                 `;
                 
                 modal.appendChild(dialog);
                 document.body.appendChild(modal);
                 
                 // æ·»åŠ åŠ¨ç”»æ ·å¼
                 const style = document.createElement('style');
                 style.textContent = `
                     @keyframes fadeIn {
                         from { opacity: 0; }
                         to { opacity: 1; }
                     }
                     @keyframes slideIn {
                         from { transform: scale(0.9) translateY(-20px); opacity: 0; }
                         to { transform: scale(1) translateY(0); opacity: 1; }
                     }
                 `;
                 document.head.appendChild(style);
                 
                 // ç»‘å®šäº‹ä»¶
                 document.getElementById('confirm-ok').addEventListener('click', () => {
                     document.body.removeChild(modal);
                     document.head.removeChild(style);
                     resolve(true);
                 });
                 
                 document.getElementById('confirm-cancel').addEventListener('click', () => {
                     document.body.removeChild(modal);
                     document.head.removeChild(style);
                     resolve(false);
                 });
                 
                 // ç‚¹å‡»èƒŒæ™¯å…³é—­
                 modal.addEventListener('click', (e) => {
                     if (e.target === modal) {
                         document.body.removeChild(modal);
                         document.head.removeChild(style);
                         resolve(false);
                     }
                 });
                 
                 // æŒ‰é’®æ‚¬åœæ•ˆæœ
                 const cancelBtn = document.getElementById('confirm-cancel');
                 const okBtn = document.getElementById('confirm-ok');
                 
                 cancelBtn.addEventListener('mouseenter', () => {
                     cancelBtn.style.background = '#e9ecef';
                 });
                 cancelBtn.addEventListener('mouseleave', () => {
                     cancelBtn.style.background = '#f8f9fa';
                 });
                 
                 okBtn.addEventListener('mouseenter', () => {
                     okBtn.style.background = '#c0392b';
                 });
                 okBtn.addEventListener('mouseleave', () => {
                     okBtn.style.background = '#e74c3c';
                 });
             });
         }

          // ç¾è§‚çš„é€šçŸ¥æç¤ºå‡½æ•°
         function showNotification(message, type = 'info') {
             // åˆ›å»ºé€šçŸ¥å®¹å™¨ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰
             let container = document.getElementById('notification-container');
             if (!container) {
                 container = document.createElement('div');
                 container.id = 'notification-container';
                 container.style.cssText = `
                     position: fixed;
                     top: 20px;
                     right: 20px;
                     z-index: 10000;
                     pointer-events: none;
                 `;
                 document.body.appendChild(container);
             }
             
             // åˆ›å»ºé€šçŸ¥å…ƒç´ 
             const notification = document.createElement('div');
             notification.style.cssText = `
                 margin-bottom: 10px;
                 padding: 16px 20px;
                 border-radius: 8px;
                 color: white;
                 font-size: 14px;
                 font-weight: 500;
                 box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
                 transform: translateX(400px);
                 transition: all 0.3s ease;
                 pointer-events: auto;
                 cursor: pointer;
                 max-width: 350px;
                 word-wrap: break-word;
                 display: flex;
                 align-items: center;
                 gap: 10px;
             `;
             
             // æ ¹æ®ç±»å‹è®¾ç½®é¢œè‰²å’Œå›¾æ ‡
             let bgColor, icon;
             switch (type) {
                 case 'success':
                     bgColor = '#27ae60';
                     icon = '<i class="fas fa-check-circle"></i>';
                     break;
                 case 'error':
                     bgColor = '#e74c3c';
                     icon = '<i class="fas fa-exclamation-circle"></i>';
                     break;
                 case 'warning':
                     bgColor = '#f39c12';
                     icon = '<i class="fas fa-exclamation-triangle"></i>';
                     break;
                 default:
                     bgColor = '#3498db';
                     icon = '<i class="fas fa-info-circle"></i>';
             }
             
             notification.style.backgroundColor = bgColor;
             notification.innerHTML = `${icon}<span>${message}</span>`;
             
             // æ·»åŠ åˆ°å®¹å™¨
             container.appendChild(notification);
             
             // å»¶è¿Ÿæ˜¾ç¤ºåŠ¨ç”»
             setTimeout(() => {
                 notification.style.transform = 'translateX(0)';
             }, 10);
             
             // ç‚¹å‡»å…³é—­
             notification.addEventListener('click', () => {
                 notification.style.transform = 'translateX(400px)';
                 setTimeout(() => {
                     if (notification.parentNode) {
                         notification.parentNode.removeChild(notification);
                     }
                 }, 300);
             });
             
             // è‡ªåŠ¨å…³é—­
             setTimeout(() => {
                 if (notification.parentNode) {
                     notification.style.transform = 'translateX(400px)';
                     setTimeout(() => {
                         if (notification.parentNode) {
                             notification.parentNode.removeChild(notification);
                         }
                     }, 300);
                 }
             }, type === 'error' ? 5000 : 3000); // é”™è¯¯æ¶ˆæ¯æ˜¾ç¤ºæ›´ä¹…
         }
     </script>
    
    <!-- æ•™å­¦å¤§çº²å†å²æ¨¡æ€æ¡† -->
    <div id="outline-history-modal" class="course-modal-overlay">
        <div class="course-modal-container" style="max-width: 1000px;">
            <div class="course-modal-header">
                <div class="modal-title-section">
                    <div class="modal-icon">
                        <i class="fas fa-folder-open"></i>
                    </div>
                    <h3>æˆ‘çš„æ•™å­¦å¤§çº²</h3>
                </div>
                <button id="close-history-modal" class="modal-close-btn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="course-modal-body">
                <!-- ç­›é€‰å™¨ -->
                <div class="history-filters" style="margin-bottom: 20px; display: flex; gap: 15px; align-items: flex-end; flex-wrap: wrap;">
                    <div style="flex: 1; min-width: 400px;">
                        <label class="course-form-label">ç­›é€‰è¯¾ç¨‹ï¼š</label>
                        <select id="history-course-filter" class="course-form-input" style="width: 100%; height: 50px; font-size: 14px; min-width: 400px; max-width: 600px; line-height: 1.5; padding: 12px 30px 12px 12px;">
                            <option value="">æ‰€æœ‰è¯¾ç¨‹</option>
                        </select>
                    </div>
                    <button class="btn btn-accent" onclick="refreshOutlineHistory()" style="height: 50px; padding: 0 16px; display: flex; align-items: center; gap: 8px;">
                        <i class="fas fa-sync-alt"></i> åˆ·æ–°
                    </button>
                </div>
                
                <!-- å†å²è®°å½•åˆ—è¡¨ -->
                <div class="history-list" style="max-height: 500px; overflow-y: auto;">
                    <div id="history-loading" style="text-align: center; padding: 40px; color: #7f8c8d;">
                        <i class="fas fa-spinner fa-spin"></i> åŠ è½½ä¸­...
                    </div>
                    <div id="history-empty" style="display: none; text-align: center; padding: 40px; color: #7f8c8d;">
                        <i class="fas fa-folder-open"></i><br>
                        æš‚æ— å·²ä¿å­˜çš„æ•™å­¦å¤§çº²
                    </div>
                    <div id="history-content"></div>
                </div>
            </div>
            
            <div class="course-modal-footer" style="display: none;">
                <!-- ç§»é™¤å…³é—­æŒ‰é’® -->
            </div>
        </div>
    </div>
    
    <!-- å¤§çº²è¯¦æƒ…æŸ¥çœ‹æ¨¡æ€æ¡† -->
    <div id="outline-detail-modal" class="course-modal-overlay">
        <div class="course-modal-container" style="max-width: 800px; max-height: 95vh;">
            <div class="course-modal-header">
                <div class="modal-title-section">
                    <div class="modal-icon">
                        <i class="fas fa-file-alt"></i>
                    </div>
                    <h3 id="outline-detail-title">æ•™å­¦å¤§çº²è¯¦æƒ…</h3>
                </div>
                <button id="close-detail-modal" class="modal-close-btn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="course-modal-body" style="padding: 20px; overflow: hidden;">
                <div id="outline-detail-content" style="max-height: 900px; overflow-y: auto; padding: 20px; background: #f8f9fa; border-radius: 8px; line-height: 1.7;">
                    <!-- åŠ¨æ€åŠ è½½å¤§çº²å†…å®¹ -->
                </div>
            </div>
            
            <div class="course-modal-footer" style="display: flex; gap: 12px; justify-content: center; flex-wrap: wrap; padding: 15px 20px; margin-top: 20px; border-top: 1px solid #e9ecef;">

                <button id="apply-outline" class="btn btn-primary" onclick="applyCurrentOutline()" style="flex: 0 0 auto; min-width: 120px; height: 40px;">
                    <i class="fas fa-copy"></i> åº”ç”¨æ­¤å¤§çº²
                </button>
                <button id="download-outline" class="btn btn-accent" onclick="downloadCurrentOutline()" style="flex: 0 0 auto; min-width: 100px; height: 40px;">
                    <i class="fas fa-file-pdf"></i> ä¸‹è½½PDF
                </button>
            </div>
        </div>
    </div>

    <!-- çŸ¥è¯†å—æŸ¥çœ‹æ¨¡æ€æ¡† -->
    <div id="knowledge-chunks-modal" class="course-modal-overlay">
        <div class="course-modal-container" style="width: 900px; max-width: 95vw; height: 700px; max-height: 90vh; display: flex; flex-direction: column;">
            <div class="course-modal-header">
                <div class="modal-title-section">
                    <div class="modal-icon" style="background: rgba(255, 255, 255, 0.2);">
                        <i class="fas fa-list" style="color: white;"></i>
                    </div>
                    <h3 id="chunks-modal-title">çŸ¥è¯†å—è¯¦æƒ…</h3>
                </div>
                <button id="close-chunks-modal" class="modal-close-btn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="course-modal-body" style="flex: 1; display: flex; flex-direction: column; overflow: hidden; padding: 20px;">
                <div class="chunks-info" style="padding: 16px; background: #f8f9fa; border-radius: 8px; margin-bottom: 20px; flex-shrink: 0;">
                    <div id="chunks-course-info" style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <strong id="chunks-course-name">è¯¾ç¨‹åç§°</strong>
                            <span style="color: #7f8c8d; margin-left: 10px;" id="chunks-course-code">è¯¾ç¨‹ä»£ç </span>
                        </div>
                        <div style="color: #7f8c8d;">
                            å…± <span id="chunks-total-count">0</span> ä¸ªçŸ¥è¯†å—
                        </div>
                    </div>
                </div>
                
                <div class="chunks-filters" style="margin-bottom: 20px; display: flex; gap: 10px; align-items: center; flex-shrink: 0;">
                    <input type="text" id="chunks-search" class="form-input" placeholder="æœç´¢çŸ¥è¯†å—å†…å®¹..." style="flex: 1;">
                    <select id="chunks-file-filter" class="form-select" style="width: 200px;">
                        <option value="">æ‰€æœ‰æ–‡ä»¶</option>
                    </select>
                </div>
                
                <div class="chunks-content" style="flex: 1; position: relative; min-height: 0;">
                    <div id="chunks-loading" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; color: #7f8c8d;">
                        <i class="fas fa-spinner fa-spin"></i> åŠ è½½çŸ¥è¯†å—æ•°æ®ä¸­...
                    </div>
                    
                    <div id="chunks-list" style="display: none; height: 100%; overflow-y: auto; padding-right: 8px;">
                        <!-- åŠ¨æ€åŠ è½½çŸ¥è¯†å—åˆ—è¡¨ -->
                    </div>
                    
                    <div id="chunks-empty" style="display: none; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; color: #7f8c8d;">
                        <i class="fas fa-puzzle-piece" style="font-size: 32px; margin-bottom: 12px; color: #bdc3c7;"></i>
                        <p>è¯¥è¯¾ç¨‹æš‚æ— çŸ¥è¯†å—æ•°æ®</p>
                        <p>ä¸Šä¼ æ–‡æ¡£åä¼šç”ŸæˆçŸ¥è¯†å—</p>
                    </div>
                </div>
            </div>
            
            <div class="course-modal-footer" style="display: none;">
                <!-- ç§»é™¤å…³é—­æŒ‰é’® -->
            </div>
        </div>
    </div>

    <!-- çŸ¥è¯†å—è¯¦æƒ…æŸ¥çœ‹æ¨¡æ€æ¡† -->
    <div id="chunk-detail-modal" class="course-modal-overlay">
        <div class="course-modal-container" style="width: 800px; max-width: 90vw; height: 600px; max-height: 90vh; display: flex; flex-direction: column;">
            <div class="course-modal-header">
                <div class="modal-title-section">
                    <div class="modal-icon" style="background: rgba(255, 255, 255, 0.2);">
                        <i class="fas fa-eye" style="color: white;"></i>
                    </div>
                    <h3 id="chunk-detail-title">çŸ¥è¯†å—è¯¦æƒ…</h3>
                </div>
                <button id="close-chunk-detail-modal" class="modal-close-btn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="course-modal-body" style="flex: 1; display: flex; flex-direction: column; overflow: hidden; padding: 20px;">
                <div class="chunk-detail-info" style="padding: 16px; background: #f8f9fa; border-radius: 8px; margin-bottom: 20px; flex-shrink: 0;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                        <div>
                            <strong id="chunk-detail-name">çŸ¥è¯†å— #1</strong>
                            <span style="color: #7f8c8d; margin-left: 10px;" id="chunk-detail-file">æ–‡ä»¶å</span>
                        </div>
                        <div>
                            <span id="chunk-detail-status" class="badge badge-success">å·²å¤„ç†</span>
                        </div>
                    </div>
                    <div style="font-size: 12px; color: #95a5a6;">
                        <span>å—ID: <span id="chunk-detail-id">-</span></span>
                        <span style="margin-left: 20px;">åˆ›å»ºæ—¶é—´: <span id="chunk-detail-time">-</span></span>
                    </div>
                </div>
                
                <div class="chunk-detail-content" style="flex: 1; display: flex; flex-direction: column; min-height: 0;">
                    <h5 style="margin-bottom: 12px; color: #2c3e50; flex-shrink: 0;">
                        <i class="fas fa-file-text"></i> å®Œæ•´å†…å®¹
                    </h5>
                    <div id="chunk-content-display" style="flex: 1; overflow-y: auto; padding: 16px; background: white; border: 1px solid #e9ecef; border-radius: 8px; line-height: 1.6; font-size: 14px; white-space: pre-wrap;">
                        <!-- åŠ¨æ€åŠ è½½çŸ¥è¯†å—å®Œæ•´å†…å®¹ -->
                    </div>
                </div>
            </div>
            
            <div class="course-modal-footer" style="display: none;">
                <!-- ç§»é™¤å…³é—­æŒ‰é’® -->
            </div>
        </div>
    </div>

    <!-- çŸ¥è¯†å—ç¼–è¾‘æ¨¡æ€æ¡† -->
    <div id="edit-chunk-modal" class="course-modal-overlay">
        <div class="course-modal-container" style="width: 800px; max-width: 90vw; height: 600px; max-height: 90vh; display: flex; flex-direction: column;">
            <div class="course-modal-header">
                <div class="modal-title-section">
                    <div class="modal-icon" style="background: rgba(255, 255, 255, 0.2);">
                        <i class="fas fa-edit" style="color: white;"></i>
                    </div>
                    <h3 id="edit-chunk-title">ç¼–è¾‘çŸ¥è¯†å—</h3>
                </div>
                <button id="close-edit-chunk-modal" class="modal-close-btn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="course-modal-body" style="flex: 1; display: flex; flex-direction: column; overflow: hidden; padding: 20px;">
                <div class="edit-chunk-info" style="padding: 16px; background: #f8f9fa; border-radius: 8px; margin-bottom: 20px; flex-shrink: 0;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                        <div>
                            <strong id="edit-chunk-name">çŸ¥è¯†å— #1</strong>
                            <span style="color: #7f8c8d; margin-left: 10px;" id="edit-chunk-file">æ–‡ä»¶å</span>
                        </div>
                        <div>
                            <span id="edit-chunk-status" class="badge badge-success">å·²å¤„ç†</span>
                        </div>
                    </div>
                    <div style="font-size: 12px; color: #95a5a6;">
                        <span>å—ID: <span id="edit-chunk-id">-</span></span>
                        <span style="margin-left: 20px;">åˆ›å»ºæ—¶é—´: <span id="edit-chunk-time">-</span></span>
                    </div>
                </div>
                
                <div class="edit-chunk-content" style="flex: 1; display: flex; flex-direction: column; min-height: 0;">
                    <h5 style="margin-bottom: 12px; color: #2c3e50; flex-shrink: 0;">
                        <i class="fas fa-file-text"></i> ç¼–è¾‘å†…å®¹
                    </h5>
                    <textarea id="edit-chunk-textarea" style="flex: 1; padding: 16px; border: 1px solid #e9ecef; border-radius: 8px; line-height: 1.6; font-size: 14px; resize: none; font-family: inherit;" placeholder="è¯·è¾“å…¥çŸ¥è¯†å—å†…å®¹..."></textarea>
                </div>
            </div>
            
            <div class="course-modal-footer" style="display: flex; gap: 12px; justify-content: center; padding: 15px 20px; border-top: 1px solid #e9ecef;">
                <button type="button" class="btn btn-secondary" onclick="hideEditChunkModal()">
                    <i class="fas fa-times"></i> å–æ¶ˆ
                </button>
                <button type="button" class="btn btn-success" onclick="saveChunkEdit()">
                    <i class="fas fa-save"></i> ä¿å­˜
                </button>
            </div>
        </div>
    </div>

    <!-- ç¡®è®¤å¯¹è¯æ¡†æ¨¡æ€æ¡† -->
    <div id="confirm-modal" class="course-modal-overlay">
        <div class="course-modal-container" style="max-width: 450px;">
            <div class="course-modal-header">
                <div class="modal-title-section">
                    <div class="modal-icon" style="background: rgba(243, 156, 18, 0.1);">
                        <i class="fas fa-exclamation-triangle" style="color: #f39c12;"></i>
                    </div>
                    <h3 id="confirm-title">ç¡®è®¤æ“ä½œ</h3>
                </div>
            </div>
            
            <div class="course-modal-body">
                <div id="confirm-message" style="padding: 20px 0; font-size: 16px; line-height: 1.6; color: #2c3e50;">
                    ç¡®å®šè¦æ‰§è¡Œæ­¤æ“ä½œå—ï¼Ÿ
                </div>
            </div>
            
            <div class="course-modal-footer">
                <button id="confirm-cancel-btn" class="btn btn-secondary">
                    <i class="fas fa-times"></i> å–æ¶ˆ
                </button>
                <button id="confirm-ok-btn" class="btn btn-warning">
                    <i class="fas fa-check"></i> ç¡®å®š
                </button>
            </div>
        </div>
    </div>

    <!-- å‘å¸ƒè¯•å·æ¨¡æ€æ¡† -->
    <div id="publish-exam-modal" class="course-modal-overlay">
        <div class="course-modal-container" style="max-width: 500px;">
            <div class="course-modal-header">
                <div class="modal-title-section">
                    <div class="modal-icon" style="background: rgba(46, 204, 113, 0.1);">
                        <i class="fas fa-paper-plane" style="color: #2ecc71;"></i>
                    </div>
                    <h3>å‘å¸ƒè¯•å·</h3>
                </div>
                <button id="close-publish-modal" class="modal-close-btn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="course-modal-body">
                <form id="publish-exam-form">
                    <div class="publish-option">
                        <label class="publish-checkbox">
                            <input type="checkbox" id="publish-immediately" checked>
                            <span class="checkmark"></span>
                            <div class="option-content">
                                <div class="option-title">
                                    <i class="fas fa-bolt"></i>
                                    ç«‹å³å‘å¸ƒ
                                </div>
                                <div class="option-description">è¯•å·å°†ç«‹å³å¯¹å­¦ç”Ÿå¯è§ï¼Œå­¦ç”Ÿå¯ä»¥å¼€å§‹è€ƒè¯•</div>
                            </div>
                        </label>
                    </div>
                    
                    <div class="publish-divider">
                        <span>æˆ–</span>
                    </div>
                    
                    <div class="publish-option">
                        <label class="publish-checkbox">
                            <input type="checkbox" id="schedule-publish">
                            <span class="checkmark"></span>
                            <div class="option-content">
                                <div class="option-title">
                                    <i class="fas fa-clock"></i>
                                    å®šæ—¶å‘å¸ƒ
                                </div>
                                <div class="option-description">é€‰æ‹©ä¸€ä¸ªæ—¶é—´ç‚¹è‡ªåŠ¨å‘å¸ƒè¯•å·</div>
                            </div>
                        </label>
                    </div>
                    
                    <div id="schedule-settings" class="schedule-settings">
                        <div class="form-group">
                            <label class="course-form-label">è€ƒè¯•å¼€å§‹æ—¶é—´ï¼š</label>
                            <input type="datetime-local" id="exam-start-time" class="course-form-input" style="width: 100%;">
                        </div>


                    </div>
                    
                    <div class="exam-info-card">
                        <div class="exam-info-item">
                            <span class="exam-info-label">è¯¾ç¨‹ï¼š</span>
                            <span id="exam-course-display">-</span>
                        </div>
                        <div class="exam-info-item">
                            <span class="exam-info-label">è¯•å·åç§°ï¼š</span>
                            <span id="exam-title-display">-</span>
                        </div>
                    </div>
                </form>
            </div>
            
            <div class="course-modal-footer" style="display: flex; justify-content: center; padding: 15px 20px 20px; margin-top: -10px;">
                <button type="button" id="confirm-publish" class="btn btn-success">
                    <i class="fas fa-paper-plane"></i> ç¡®è®¤å‘å¸ƒ
                </button>
            </div>
        </div>
    </div>

    <!-- è¯•å·é¢„è§ˆæ¨¡æ€æ¡† -->
    <div id="exam-preview-modal" class="course-modal-overlay">
        <div class="course-modal-container" style="width: 1200px; height: 800px; max-width: 95vw; max-height: 95vh; display: flex; flex-direction: column;">
            <div class="course-modal-header">
                <div class="modal-title-section">
                    <div class="modal-icon" style="background: rgba(52, 152, 219, 0.1);">
                        <i class="fas fa-eye" style="color: #3498db;"></i>
                    </div>
                    <h3><i class="fas fa-file-alt"></i> è¯•å·é¢„è§ˆ</h3>
                </div>
                <div style="display: flex; gap: 10px; align-items: center;">
                    <button id="close-preview-modal" class="modal-close-btn">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            
            <div class="course-modal-body" style="flex: 1; display: flex; flex-direction: column; overflow: hidden; padding: 0;">
                <div class="exam-preview-content" style="flex: 1; overflow-y: auto; padding: 30px; background: #f8f9fa;">
                    <div class="exam-preview-header" style="background: white; border-radius: 15px; padding: 30px; margin-bottom: 30px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                        <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 20px;">
                            <h2 id="preview-exam-title" style="color: #2c3e50; margin: 0; font-size: 24px; font-weight: 600;">AIç”Ÿæˆè¯•å· - æ•°å­—æ°´å°</h2>
                            <div style="display: flex; gap: 15px; font-size: 14px; color: #7f8c8d;">
                                <span><strong>è€ƒè¯•æ—¶é•¿ï¼š</strong><span id="preview-exam-duration">90åˆ†é’Ÿ</span></span>
                                <span><strong>æ€»åˆ†ï¼š</strong><span id="preview-exam-total-score">100åˆ†</span></span>
                                <span><strong>é¢˜ç›®æ•°ï¼š</strong><span id="preview-exam-question-count">10é¢˜</span></span>
                            </div>
                        </div>
                    </div>
                    
                    <div id="preview-questions-container" style="background: white; border-radius: 15px; padding: 30px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                        <!-- åŠ¨æ€åŠ è½½é¢˜ç›®å†…å®¹ -->
                    </div>
                </div>
            </div>
            
            <div class="course-modal-footer" style="display: flex; gap: 12px; justify-content: flex-end; padding: 15px 20px; border-top: 1px solid #e9ecef;">
                <button type="button" class="btn btn-secondary" onclick="hideExamPreviewModal()">
                    <i class="fas fa-arrow-left"></i> è¿”å›
                </button>
                <button type="button" class="btn btn-primary" onclick="editExamFromPreview()">
                    <i class="fas fa-edit"></i> ç¼–è¾‘
                </button>
                <button type="button" class="btn btn-success" onclick="publishExamFromPreview()">
                    <i class="fas fa-paper-plane"></i> å‘å¸ƒ
                </button>
                <button type="button" class="btn btn-info" onclick="exportExamFromPreview()">
                    <i class="fas fa-download"></i> å¯¼å‡º
                </button>
            </div>
        </div>
    </div>

    <!-- è¯•å·ç¼–è¾‘æ¨¡æ€æ¡† -->
    <div id="exam-edit-modal" class="course-modal-overlay">
        <div class="course-modal-container" style="width: 1400px; height: 800px; max-width: 95vw; max-height: 95vh; display: flex; flex-direction: column;">
            <div class="course-modal-header">
                <div class="modal-title-section">
                    <div class="modal-icon" style="background: rgba(46, 204, 113, 0.1);">
                        <i class="fas fa-edit" style="color: #2ecc71;"></i>
                    </div>
                    <h3><i class="fas fa-edit"></i> è¯•å·ç¼–è¾‘</h3>
                </div>
                <div style="display: flex; gap: 10px; align-items: center;">
                    <div style="font-size: 12px; color: #000000;">
                        <i class="fas fa-eye"></i> å®æ—¶é¢„è§ˆ
                    </div>
                    <button id="close-edit-modal" class="modal-close-btn">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            
            <div class="course-modal-body" style="flex: 1; display: flex; overflow: hidden; padding: 0;">
                <!-- Markdownç¼–è¾‘å™¨ -->
                <div class="markdown-editor-panel" style="flex: 1; display: flex; flex-direction: column; border-right: 1px solid #e9ecef;">
                    <div class="editor-header" style="padding: 15px 20px; background: #f8f9fa; border-bottom: 1px solid #e9ecef; display: flex; align-items: center; gap: 10px;">
                        <i class="fas fa-edit" style="color: #2ecc71;"></i>
                        <span style="font-weight: 500;">Markdownç¼–è¾‘å™¨</span>
                    </div>
                    <textarea id="exam-markdown-editor" style="flex: 1; border: none; outline: none; padding: 20px; font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace; font-size: 13px; line-height: 1.6; resize: none; background: white;" placeholder="### é¢˜ç›®10ï¼ˆå•é¡¹é€‰æ‹©é¢˜ï¼‰

**é¢˜ç›®å†…å®¹**ï¼šè‹¥åµŒå…¥çš„ç§˜å¯†ä¿¡æ¯ä¸º01001000ï¼Œæå–æ—¶è¯¯ç ç‡ä¸º0.50ï¼Œåˆ™æœ‰å¤šå°‘æ¯”ç‰¹å‘ç”Ÿå˜åŒ–ï¼Ÿ

**é€‰é¡¹**ï¼š
A. A. 2
B. B. 4  
C. C. 6
D. D. 8

**æ­£ç¡®ç­”æ¡ˆ**ï¼šB

**è§£æ**ï¼šè¯¯ç ç‡=é”™è¯¯æ¯”ç‰¹æ•°/æ€»æ¯”ç‰¹æ•°ï¼Œ0.50Ã—8=4ï¼ˆçŸ¥è¯†å—7ï¼‰ã€‚

**åˆ†å€¼å»ºè®®**ï¼š10åˆ†

---"></textarea>
                </div>
                
                <!-- å®æ—¶é¢„è§ˆ -->
                <div class="preview-panel" style="flex: 1; display: flex; flex-direction: column;">
                    <div class="preview-header" style="padding: 15px 20px; background: #f8f9fa; border-bottom: 1px solid #e9ecef; display: flex; align-items: center; gap: 10px;">
                        <i class="fas fa-eye" style="color: #3498db;"></i>
                        <span style="font-weight: 500;"></span>
                    </div>
                    <div id="exam-preview-panel" style="flex: 1; overflow-y: auto; padding: 20px; background: white;">
                        <div style="color: #95a5a6; text-align: center; padding: 50px; font-style: italic;">
                            å¼€å§‹ç¼–è¾‘ä»¥æŸ¥çœ‹é¢„è§ˆ...
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="course-modal-footer" style="display: flex; gap: 12px; justify-content: center; padding: 15px 20px; border-top: 1px solid #e9ecef;">
                <button type="button" class="btn btn-secondary" onclick="hideExamEditModal()">
                    <i class="fas fa-times"></i> å–æ¶ˆ
                </button>
                <button type="button" class="btn btn-success" onclick="saveExamEdit()">
                    <i class="fas fa-save"></i> ä¿å­˜ä¿®æ”¹
                </button>
            </div>
        </div>
    </div>

    <!-- æˆ‘çš„æŠ¥å‘Šå¼¹çª— -->
    <div id="myReportsModal" class="course-modal-overlay">
        <div class="course-modal-container" style="max-width: 1000px;">
            <div class="course-modal-header">
                <div class="modal-title-section">
                    <div class="modal-icon">
                        <i class="fas fa-history"></i>
                    </div>
                    <h3>æˆ‘çš„æŠ¥å‘Š</h3>
                </div>
                <button id="close-my-reports-modal" class="modal-close-btn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="course-modal-body">
                <div class="reports-toolbar" style="margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center;">
                    <div style="color: #6c757d; font-size: 14px;">
                        <i class="fas fa-info-circle"></i> 
                        å…± <span id="reports-count">0</span> ä¸ªæŠ¥å‘Š
                    </div>
                    <div>
                        <button class="btn btn-sm btn-danger" onclick="clearAllReports()" id="clear-all-btn" style="display: none;">
                            <i class="fas fa-trash-alt"></i> æ¸…ç©ºå…¨éƒ¨
                        </button>
                    </div>
                </div>
                
                <div id="reports-list" class="reports-list">
                    <!-- åŠ¨æ€åŠ è½½æŠ¥å‘Šåˆ—è¡¨ -->
                </div>
                
                <div id="empty-reports" class="empty-state" style="display: none; text-align: center; padding: 60px 20px; color: #6c757d;">
                    <i class="fas fa-file-alt" style="font-size: 48px; margin-bottom: 20px; opacity: 0.3;"></i>
                    <h5 style="margin-bottom: 10px;">æš‚æ— æŠ¥å‘Š</h5>
                    <p style="margin: 0; font-size: 14px;">ç”Ÿæˆæ•™å­¦æ”¹è¿›å»ºè®®åï¼ŒæŠ¥å‘Šå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ</p>
                </div>
            </div>
        </div>
    </div>

    <!-- ä¸ªäººä¿¡æ¯ç¼–è¾‘æ¨¡æ€æ¡† -->
    <div id="profile-modal" class="course-modal-overlay">
        <div class="course-modal-container" style="max-width: 600px;">
            <div class="course-modal-header">
                <div class="modal-title-section">
                    <div class="modal-icon">
                        <i class="fas fa-user-edit"></i>
                    </div>
                    <h3>ç¼–è¾‘ä¸ªäººä¿¡æ¯</h3>
                </div>
                <button id="close-profile-modal" class="modal-close-btn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="course-modal-body">
                <form id="profile-form">
                    <!-- å¤´åƒä¸Šä¼  -->
                    <div class="course-form-group">
                        <label class="course-form-label">
                            <i class="fas fa-user-circle"></i>
                            å¤´åƒ
                        </label>
                        <div class="avatar-upload-section">
                            <div class="current-avatar" id="profile-avatar-preview">
                                <i class="fas fa-user"></i>
                            </div>
                            <div class="avatar-upload-controls">
                                <input type="file" id="profile-avatar" name="avatar" accept="image/*" style="display: none;">
                                <label for="profile-avatar" class="btn btn-sm btn-primary">
                                    <i class="fas fa-camera"></i>
                                    æ›´æ¢å¤´åƒ
                                </label>
                                <button type="button" id="remove-avatar" class="btn btn-sm btn-secondary">
                                    <i class="fas fa-trash"></i>
                                    åˆ é™¤å¤´åƒ
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- åŸºæœ¬ä¿¡æ¯ -->
                    <div class="course-form-group">
                        <label class="course-form-label">
                            <i class="fas fa-user"></i>
                            ç”¨æˆ·å
                        </label>
                        <input type="text" id="profile-username" name="username" class="course-form-input" readonly style="background-color: #f8f9fa; color: #6c757d;">
                    </div>
                    
                    <div class="course-form-group">
                        <label class="course-form-label">
                            <i class="fas fa-id-card"></i>
                            çœŸå®å§“å <span class="required">*</span>
                        </label>
                        <input type="text" id="profile-realname" name="realName" class="course-form-input" required>
                    </div>
                    
                    <div class="course-form-group">
                        <label class="course-form-label">
                            <i class="fas fa-envelope"></i>
                            é‚®ç®±
                        </label>
                        <input type="email" id="profile-email" name="email" class="course-form-input">
                    </div>
                    
                    <div class="course-form-group">
                        <label class="course-form-label">
                            <i class="fas fa-phone"></i>
                            æ‰‹æœºå·
                        </label>
                        <input type="tel" id="profile-phone" name="phone" class="course-form-input">
                    </div>
                    
                    <!-- å¯†ç ä¿®æ”¹ -->
                    <div class="course-form-group">
                        <label class="course-form-label">
                            <i class="fas fa-key"></i>
                            ä¿®æ”¹å¯†ç 
                        </label>
                        <div class="password-change-section">
                            <input type="password" id="profile-old-password" name="oldPassword" class="course-form-input" placeholder="è¯·è¾“å…¥å½“å‰å¯†ç ">
                            <input type="password" id="profile-new-password" name="newPassword" class="course-form-input" placeholder="è¯·è¾“å…¥æ–°å¯†ç ï¼ˆå¯é€‰ï¼‰">
                            <input type="password" id="profile-confirm-password" name="confirmPassword" class="course-form-input" placeholder="ç¡®è®¤æ–°å¯†ç ">
                            <div class="password-strength" id="profile-password-strength">
                                <div class="strength-bar">
                                    <div class="strength-fill" id="profile-strength-fill"></div>
                                </div>
                                <div class="strength-text" id="profile-strength-text">å¯†ç å¼ºåº¦ï¼šå¼±</div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            
            <div class="course-modal-footer">
                <button type="button" id="cancel-profile" class="btn btn-secondary">
                    <i class="fas fa-times"></i>
                    å–æ¶ˆ
                </button>
                <button type="button" id="save-profile" class="btn btn-primary">
                    <i class="fas fa-save"></i>
                    ä¿å­˜ä¿®æ”¹
                </button>
            </div>
        </div>
    </div>

    <!-- å¤§ä½œä¸šè¦æ±‚è®¾ç½®æ¨¡æ€æ¡† -->
    <div id="assignment-requirement-modal" class="course-modal-overlay" style="display: none;">
        <div class="course-modal-container" style="max-width: 800px;">
            <div class="course-modal-header">
                <div class="modal-title-section">
                    <div class="modal-icon">
                        <i class="fas fa-tasks"></i>
                    </div>
                    <h3>è®¾ç½®å¤§ä½œä¸šè¦æ±‚</h3>
                </div>
                <button id="close-assignment-requirement-modal" class="modal-close-btn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="course-modal-body">
                <div class="assignment-info" style="background: #e8f5e8; border: 1px solid #c3e6cb; border-radius: 8px; padding: 16px; margin-bottom: 20px;">
                    <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                        <i class="fas fa-info-circle" style="color: #155724;"></i>
                        <span style="font-weight: 600; color: #155724;">ä½œä¸šä¿¡æ¯</span>
                    </div>
                    <div style="color: #155724; font-size: 14px; line-height: 1.6;">
                        <div><strong>é¢˜ç›®ï¼š</strong><span id="assignment-question-title">å¤§ä½œä¸š1</span></div>
                        <div><strong>åˆ†å€¼ï¼š</strong><span id="assignment-question-score">50</span>åˆ†</div>
                        <div><strong>æäº¤æ–¹å¼ï¼š</strong>æ–‡æ¡£ä¸Šä¼ ï¼ˆPDFã€Wordç­‰ï¼‰æˆ–æ–‡æœ¬è¾“å…¥</div>
                        <div><strong>è¯„åˆ†æ–¹å¼ï¼š</strong>AIæ™ºèƒ½åˆ†æ + æ•™å¸ˆå®¡æ ¸</div>
                    </div>
                </div>
                
                <form id="assignment-requirement-form">
                    <div class="course-form-group">
                        <label class="course-form-label">
                            <i class="fas fa-edit"></i>
                            ä½œä¸šå…·ä½“è¦æ±‚ <span class="required">*</span>
                        </label>
                        <textarea id="assignment-requirement-content" 
                                  class="course-form-input" 
                                  rows="8" 
                                  placeholder="è¯·è¾“å…¥è¯¦ç»†çš„ä½œä¸šè¦æ±‚ï¼ŒåŒ…æ‹¬ï¼š&#10;1. ä½œä¸šå†…å®¹å’Œç›®æ ‡&#10;2. å…·ä½“è¦æ±‚å’Œè§„èŒƒ&#10;3. è¯„åˆ†æ ‡å‡†&#10;4. æäº¤æ ¼å¼è¦æ±‚&#10;5. å…¶ä»–æ³¨æ„äº‹é¡¹&#10;&#10;ä¾‹å¦‚ï¼š&#10;è¯·å®Œæˆä¸€ä»½å…³äºäººå·¥æ™ºèƒ½åº”ç”¨çš„è°ƒç ”æŠ¥å‘Šï¼Œè¦æ±‚ï¼š&#10;1. å­—æ•°ä¸å°‘äº3000å­—&#10;2. åŒ…å«è‡³å°‘5ä¸ªçœŸå®æ¡ˆä¾‹åˆ†æ&#10;3. å¼•ç”¨ä¸å°‘äº10ç¯‡ç›¸å…³æ–‡çŒ®&#10;4. æ ¼å¼è§„èŒƒï¼Œé€»è¾‘æ¸…æ™°&#10;5. åŸåˆ›æ€§ï¼Œä¸å¾—æŠ„è¢­"
                                  required></textarea>
                        <div class="form-hint" style="margin-top: 8px; font-size: 12px; color: #6c757d;">
                            <i class="fas fa-lightbulb"></i> 
                            è¯¦ç»†çš„è¦æ±‚æœ‰åŠ©äºAIæ›´å‡†ç¡®åœ°è¯„åˆ†ã€‚å»ºè®®åŒ…å«è¯„åˆ†æ ‡å‡†ã€æ ¼å¼è¦æ±‚ç­‰å…·ä½“ä¿¡æ¯ã€‚
                        </div>
                    </div>
                    
                    <div class="course-form-group">
                        <label class="course-form-label">
                            <i class="fas fa-star"></i>
                            è¯„åˆ†æƒé‡è®¾ç½®
                        </label>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                            <div style="background: #f8f9fa; padding: 16px; border-radius: 8px;">
                                <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                                    <i class="fas fa-brain" style="color: #3498db;"></i>
                                    <span style="font-weight: 500;">å†…å®¹è´¨é‡</span>
                                </div>
                                <input type="range" id="content-weight" min="0" max="100" value="40" 
                                       style="width: 100%;" oninput="updateWeightDisplay()">
                                <div style="text-align: center; font-size: 14px; color: #666;">
                                    <span id="content-weight-text">40%</span>
                                </div>
                            </div>
                            <div style="background: #f8f9fa; padding: 16px; border-radius: 8px;">
                                <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                                    <i class="fas fa-file-alt" style="color: #e74c3c;"></i>
                                    <span style="font-weight: 500;">æ ¼å¼è§„èŒƒ</span>
                                </div>
                                <input type="range" id="format-weight" min="0" max="100" value="20" 
                                       style="width: 100%;" oninput="updateWeightDisplay()">
                                <div style="text-align: center; font-size: 14px; color: #666;">
                                    <span id="format-weight-text">20%</span>
                                </div>
                            </div>
                            <div style="background: #f8f9fa; padding: 16px; border-radius: 8px;">
                                <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                                    <i class="fas fa-lightbulb" style="color: #f39c12;"></i>
                                    <span style="font-weight: 500;">åˆ›æ–°æ€§</span>
                                </div>
                                <input type="range" id="innovation-weight" min="0" max="100" value="25" 
                                       style="width: 100%;" oninput="updateWeightDisplay()">
                                <div style="text-align: center; font-size: 14px; color: #666;">
                                    <span id="innovation-weight-text">25%</span>
                                </div>
                            </div>
                            <div style="background: #f8f9fa; padding: 16px; border-radius: 8px;">
                                <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                                    <i class="fas fa-check-circle" style="color: #27ae60;"></i>
                                    <span style="font-weight: 500;">å®Œæ•´æ€§</span>
                                </div>
                                <input type="range" id="completeness-weight" min="0" max="100" value="15" 
                                       style="width: 100%;" oninput="updateWeightDisplay()">
                                <div style="text-align: center; font-size: 14px; color: #666;">
                                    <span id="completeness-weight-text">15%</span>
                                </div>
                            </div>
                        </div>
                        <div id="weight-total" style="text-align: center; margin-top: 12px; padding: 8px; background: #e3f2fd; border-radius: 6px;">
                            <span style="font-weight: 600; color: #1976d2;">æ€»è®¡ï¼š<span id="total-weight">100</span>%</span>
                        </div>
                    </div>
                </form>
            </div>
            
            <div class="course-modal-footer">
                <button type="button" id="cancel-assignment-requirement" class="btn btn-secondary">
                    <i class="fas fa-times"></i>
                    å–æ¶ˆ
                </button>
                <button type="button" id="save-assignment-requirement" class="btn btn-primary">
                    <i class="fas fa-save"></i>
                    ä¿å­˜è¦æ±‚
                </button>
            </div>
        </div>
    </div>

    <!-- JavaScript æ–‡ä»¶å¼•å…¥ -->
    <script src="teacher-api.js"></script>
    <script src="teacher.js"></script>
<script src="messaging-functions.js"></script>
    <script src="profile.js"></script>
    
    <script>
    // ä¸´æ—¶çš„å†å²é€šçŸ¥å‡½æ•°
    function openNoticeHistory() {
        console.log('openNoticeHistory è¢«è°ƒç”¨');
        
        // æ£€æŸ¥æ˜¯å¦æœ‰loadNoticeHistoryå‡½æ•°
        if (typeof loadNoticeHistory === 'function') {
            console.log('è°ƒç”¨loadNoticeHistoryå‡½æ•°');
            loadNoticeHistory();
        } else {
            console.log('loadNoticeHistoryå‡½æ•°ä¸å­˜åœ¨ï¼Œç›´æ¥æ˜¾ç¤ºæ¨¡æ€æ¡†');
            // ç›´æ¥è°ƒç”¨æ˜¾ç¤ºæ¨¡æ€æ¡†çš„å‡½æ•°
            if (typeof showNoticeHistoryModal === 'function') {
                showNoticeHistoryModal();
            } else {
                alert('å†å²é€šçŸ¥åŠŸèƒ½æš‚æ—¶ä¸å¯ç”¨ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•');
            }
        }
    }
    </script>
</body>
</html> 